<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NDC - æ¡ˆæƒ…å›é¡¾ç³»ç»Ÿ (OVERVIEW)</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+SC:wght@400;600;700&family=Special+Elite&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0808;
            color: #e8e4d9;
            font-family: 'Noto Serif SC', serif;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* èƒŒæ™¯åœºæ™¯ */
        .scene-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1510 0%, #0d0a08 50%, #151210 100%);
            z-index: 0;
        }

        .scene-background::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 70%;
            height: 100%;
            background: radial-gradient(ellipse at 70% 50%, rgba(139,35,35,0.12) 0%, transparent 60%);
        }

        /* å™ªç‚¹çº¹ç† */
        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            height: 100vh;
            position: relative;
            z-index: 10;
        }

        /* ==================== å·¦ä¾§é¢æ¿ - æ·±è‰²æ¡£æ¡ˆé£æ ¼ ==================== */
        .left-panel {
            width: 400px;
            background: linear-gradient(180deg, #1a1412 0%, #0d0a09 100%);
            border-right: 1px solid #3a2a20;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 10px 0 40px rgba(0,0,0,0.5);
        }

        /* è¾¹ç¼˜å…‰æ™•æ•ˆæœ - å‚è€ƒè®¾ç½®ç³»ç»Ÿ */
        .left-panel::after {
            content: '';
            position: absolute;
            top: 0;
            right: -12px;
            width: 12px;
            height: 100%;
            background: linear-gradient(90deg,
                rgba(107,28,28,0.12) 0%,
                rgba(107,28,28,0.05) 50%,
                transparent 100%
            );
            z-index: 2;
        }

        /* ç« èŠ‚æ ‡é¢˜ */
        .chapter-header {
            padding: 25px 20px;
            background: transparent;
            position: relative;
        }

        .chapter-header h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            color: #d4af37;
            letter-spacing: 3px;
            margin-bottom: 8px;
        }

        .chapter-header .subtitle {
            font-size: 0.9em;
            color: #8a7a6a;
        }

        /* å°ç« è£…é¥° - å‚è€ƒè®¾ç½®ç³»ç»Ÿ */
        .stamp-decoration {
            position: absolute;
            top: 18px;
            right: 18px;
            width: 55px;
            height: 55px;
            border: 2px solid rgba(212,175,55,0.35);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(-15deg);
            opacity: 0.7;
        }

        .stamp-decoration span {
            font-family: 'Special Elite', cursive;
            font-size: 0.45em;
            color: rgba(212,175,55,0.6);
            text-align: center;
            line-height: 1.2;
        }

        /* æ¡ˆä»¶å¡ç‰‡åŒºåŸŸ */
        .case-file-area {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
        }

        /* æ¡£æ¡ˆå¡ç‰‡ - çº¢è‰²æ¡£æ¡ˆé£æ ¼ + å‚è€ƒè®¾ç½®ç³»ç»Ÿçš„è¾¹ç¼˜æ•ˆæœ */
        .case-file {
            background: linear-gradient(135deg, #6B1C1C 0%, #4a1515 50%, #2a0a0a 100%);
            border: 2px solid #8a3030;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow:
                0 4px 15px rgba(0,0,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.05);
        }

        .case-file::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 6px;
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .case-file:hover {
            transform: translateX(5px);
            box-shadow:
                -5px 5px 25px rgba(107,28,28,0.5),
                0 0 15px rgba(139,35,35,0.3),
                inset 0 1px 0 rgba(255,255,255,0.08);
            border-color: #aa4040;
        }

        .case-file.active {
            border-color: #d4af37;
            box-shadow:
                0 0 25px rgba(212,175,55,0.35),
                0 0 50px rgba(212,175,55,0.15),
                inset 0 0 20px rgba(212,175,55,0.1);
        }

        .case-file.locked {
            opacity: 0.4;
            filter: grayscale(0.6);
            cursor: not-allowed;
        }

        .case-file.locked:hover {
            transform: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        /* æ¡ˆä»¶æ ‡é¢˜ - é€‚é…æµ…è‰²èƒŒæ™¯ */
        .case-file .file-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .case-file .case-title {
            font-family: 'Special Elite', cursive;
            font-size: 0.75em;
            color: #c9a86c;
            letter-spacing: 1px;
            margin-bottom: 3px;
        }

        .case-file .case-name {
            font-size: 1.1em;
            color: #fff;
            font-weight: 600;
        }

        .case-file.active .case-name,
        .case-file.active .case-title {
            color: #d4af37;
        }

        /* çŠ¶æ€æ ‡ç­¾ - æ·±è‰²æ¡£æ¡ˆå¡ç‰‡é€‚é… */
        .status-badge {
            font-size: 0.65em;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: 600;
        }

        .status-badge.completed {
            background: rgba(76,175,80,0.25);
            color: #6fcf70;
            border: 1px solid #4caf50;
        }

        .status-badge.current {
            background: rgba(255,193,7,0.25);
            color: #ffd54f;
            border: 1px solid #ffc107;
        }

        .status-badge.locked {
            background: rgba(100,100,100,0.25);
            color: #999;
            border: 1px solid #666;
        }

        .case-file.active .status-badge {
            background: rgba(212,175,55,0.3);
            color: #d4af37;
            border-color: rgba(212,175,55,0.6);
        }

        /* æ¡ˆä»¶ä¿¡æ¯ - æ·±è‰²æ¡£æ¡ˆå¡ç‰‡é€‚é… */
        .case-file .case-info {
            font-size: 0.8em;
            color: #c9a86c;
            line-height: 1.5;
        }

        .case-file .case-info .target {
            color: #d4af37;
            font-weight: 600;
        }

        .case-file.active .case-info,
        .case-file.active .case-info .target {
            color: #fff;
        }

        .case-file .case-info .hidden {
            color: #8a7a6a;
            font-style: italic;
        }

        .case-file .case-name.hidden-name {
            color: #8a7a6a;
            font-style: italic;
        }

        /* å°ç«  - æ·±è‰²æ¡£æ¡ˆå¡ç‰‡é€‚é… */
        .stamp-overlay {
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%) rotate(-12deg);
            font-family: 'Special Elite', cursive;
            font-size: 1.4em;
            padding: 5px 12px;
            border: 2px solid;
            border-radius: 5px;
            opacity: 0.8;
        }

        .stamp-overlay.solved {
            color: #6fcf70;
            border-color: #4caf50;
        }

        .case-file.active .stamp-overlay.solved {
            color: #d4af37;
            border-color: rgba(212,175,55,0.8);
        }

        .stamp-overlay.progress {
            color: #ffd54f;
            border-color: #ffc107;
            font-size: 1.2em;
        }

        /* ==================== ä¸­é—´é¢æ¿ - å‚ç›´æ—¶é—´çº¿ ==================== */
        .center-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: transparent;
        }

        /* é¡¶éƒ¨æ ‡é¢˜ */
        .panel-header {
            padding: 25px 35px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .panel-title h1 {
            font-family: 'Cinzel', serif;
            font-size: 1.8em;
            color: #d4af37;
            letter-spacing: 4px;
        }

        .panel-title .cn {
            font-size: 1em;
            color: #8B2323;
        }

        .close-btn {
            padding: 10px 25px;
            background: linear-gradient(180deg, #3a2a20 0%, #2d1f15 50%, #2a1a10 100%);
            border: 1px solid #8B2323;
            color: #e8e4d9;
            font-family: 'Noto Serif SC', serif;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 3px 10px rgba(0,0,0,0.25);
            position: relative;
            overflow: hidden;
        }

        .close-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255,255,255,0.06) 0%, transparent 100%);
            pointer-events: none;
        }

        .close-btn:hover {
            background: linear-gradient(180deg, #4a3a30 0%, #3d2d22 50%, #3a2a20 100%);
            border-color: #d4af37;
            box-shadow: 0 0 12px rgba(212,175,55,0.25), 0 4px 12px rgba(0,0,0,0.3);
            transform: translateY(-1px);
        }

        .close-btn:active {
            transform: translateY(0);
        }

        /* æ—¶é—´çº¿å®¹å™¨ - å‚ç›´æ»šåŠ¨ */
        .timeline-container {
            flex: 1;
            overflow-y: auto;
            padding: 30px 50px;
            position: relative;
        }

        /* å‚ç›´æ—¶é—´çº¿ */
        .vertical-timeline {
            position: relative;
            padding-left: 60px;
        }

        /* æ—¶é—´çº¿ä¸»è½´ */
        .vertical-timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #8b7355, #5a4a3a, #3a2a20);
        }

        /* å¾ªç¯èŠ‚ç‚¹ç»„ */
        .loop-group {
            margin-bottom: 40px;
            position: relative;
        }

        /* å¾ªç¯æ ‡é¢˜ */
        .loop-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .loop-marker {
            position: absolute;
            left: -48px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B2323, #5a1515);
            border: 3px solid #aa4040;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Special Elite', cursive;
            font-size: 0.8em;
            color: #fff;
            z-index: 10;
        }

        .loop-marker.completed {
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            border-color: #4caf50;
        }

        .loop-marker.current {
            background: linear-gradient(135deg, #f57c00, #e65100);
            border-color: #ffc107;
            animation: pulse 2s infinite;
        }

        .loop-marker.locked {
            background: #333;
            border-color: #555;
            color: #666;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255,193,7,0.5); }
            50% { box-shadow: 0 0 0 10px rgba(255,193,7,0); }
        }

        .loop-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.1em;
            color: #d4af37;
            letter-spacing: 1px;
        }

        /* äº‹ä»¶èŠ‚ç‚¹ */
        .event-node {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-left: 10px;
            position: relative;
        }

        .event-node::before {
            content: '';
            position: absolute;
            left: -40px;
            top: 8px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #3a2a20;
            border: 2px solid #5a4a3a;
        }

        .event-node.completed::before {
            background: #4caf50;
            border-color: #6fcf70;
        }

        .event-node.story::before {
            border-color: #e85a5a;
        }

        .event-node.completed.story::before {
            background: #e85a5a;
        }

        .event-node.video::before {
            border-color: #9a5ae8;
        }

        .event-node.completed.video::before {
            background: #9a5ae8;
        }

        .event-content {
            background: rgba(30,25,20,0.85);
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 12px 15px;
            flex: 1;
            max-width: 500px;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .event-node.completed .event-content {
            cursor: pointer;
        }

        .event-node.completed .event-content:hover {
            border-color: #8b7355;
            background: rgba(45,38,32,0.95);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 10px rgba(139,115,85,0.15);
            transform: translateX(3px);
        }

        .event-content h4 {
            font-size: 0.95em;
            color: #c9a86c;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .event-content h4 .title-text {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .event-content .expand-arrow {
            color: #8b7355;
            font-size: 0.8em;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .event-content.expanded .expand-arrow {
            transform: rotate(180deg);
        }

        .event-content p {
            font-size: 0.85em;
            color: #8b7a6a;
            line-height: 1.5;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            margin-top: 0;
            transition: all 0.3s ease;
        }

        .event-content.expanded p {
            max-height: 200px;
            opacity: 1;
            margin-top: 10px;
        }

        .event-tag {
            display: inline-block;
            font-size: 0.7em;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 8px;
        }

        .event-tag.story {
            background: rgba(232,90,90,0.2);
            color: #e85a5a;
            border: 1px solid #e85a5a;
        }

        .event-tag.video {
            background: rgba(154,90,232,0.2);
            color: #9a5ae8;
            border: 1px solid #9a5ae8;
        }

        /* é”å®šå†…å®¹ */
        .locked-content {
            color: #555;
            font-style: italic;
            padding: 15px;
        }

        /* ==================== å³ä¾§é¢æ¿ - è¯¦æƒ…ä¸æ“ä½œ ==================== */
        .right-panel {
            width: 320px;
            background: linear-gradient(180deg, #1a1412 0%, #0d0a09 100%);
            border-left: 1px solid #3a2a20;
            display: flex;
            flex-direction: column;
        }

        .detail-section {
            padding: 20px;
            border-bottom: 1px solid #2a1a10;
        }

        .detail-section h3 {
            font-size: 0.9em;
            color: #8b7355;
            margin-bottom: 15px;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* å½“å‰é€‰ä¸­ä¿¡æ¯ */
        .selected-info {
            background: rgba(30,25,20,0.8);
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 15px;
        }

        .selected-info .loop-name {
            font-size: 1.1em;
            color: #d4af37;
            margin-bottom: 10px;
        }

        .selected-info .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #2a1a10;
            font-size: 0.85em;
        }

        .selected-info .info-row:last-child {
            border-bottom: none;
        }

        .selected-info .label {
            color: #8b7355;
        }

        .selected-info .value {
            color: #e8e4d9;
        }

        /* è¯´æ˜æ–‡å­— */
        .hint-text {
            padding: 15px;
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 5px;
            font-size: 0.85em;
            color: #c9a86c;
            line-height: 1.6;
        }

        /* æ“ä½œæŒ‰é’® */
        .action-area {
            padding: 20px;
            margin-top: auto;
        }

        .action-btn {
            width: 100%;
            padding: 15px;
            font-family: 'Noto Serif SC', serif;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, transparent 100%);
            pointer-events: none;
        }

        .action-btn.primary {
            background: linear-gradient(180deg, #8B2323 0%, #6a1a1a 50%, #5a1515 100%);
            color: #fff;
            border: 2px solid #aa4040;
            box-shadow:
                0 4px 12px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .action-btn.primary:hover {
            background: linear-gradient(180deg, #9B3333 0%, #7a2a2a 50%, #6a2525 100%);
            border-color: #cc5050;
            box-shadow:
                0 0 20px rgba(139,35,35,0.5),
                0 6px 16px rgba(0,0,0,0.35),
                inset 0 1px 0 rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }

        .action-btn.primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .action-btn.primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .action-btn.secondary {
            background: linear-gradient(180deg, #3a3025 0%, #2d2518 50%, #252015 100%);
            color: #d4af37;
            border: 2px solid #8b7355;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }

        .action-btn.secondary:hover {
            background: linear-gradient(180deg, #4a4035 0%, #3d3328 50%, #352a20 100%);
            border-color: #a08a65;
            box-shadow:
                0 0 15px rgba(139,115,85,0.3),
                0 6px 16px rgba(0,0,0,0.3);
            transform: translateY(-2px);
        }

        .action-btn.doc {
            background: linear-gradient(180deg, #1a3a5a 0%, #153050 50%, #0a2a4a 100%);
            color: #5aafe8;
            border: 2px solid #3a7aba;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
        }

        .action-btn.doc:hover {
            background: linear-gradient(180deg, #2a4a6a 0%, #1f3f5a 50%, #1a3a5a 100%);
            border-color: #4a8aca;
            box-shadow:
                0 0 15px rgba(90,175,232,0.4),
                0 6px 16px rgba(0,0,0,0.3);
            transform: translateY(-2px);
        }

        /* ==================== è¯¦æƒ…å¼¹çª— ==================== */
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1500;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .detail-modal.active {
            display: flex;
        }

        .detail-modal-content {
            width: 90%;
            max-width: 800px;
            max-height: 85vh;
            background: linear-gradient(180deg, #1a1815 0%, #0f0c0a 100%);
            border: 2px solid #8b7355;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .detail-modal-header {
            background: linear-gradient(90deg, #6B1C1C, #4a1515);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail-modal-header h2 {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.4em;
            color: #fff;
        }

        .detail-modal-header .status-tag {
            background: rgba(76,175,80,0.3);
            color: #6fcf70;
            border: 1px solid #4caf50;
            padding: 5px 15px;
            border-radius: 3px;
            font-size: 0.85em;
        }

        .detail-modal-header .status-tag.current {
            background: rgba(255,193,7,0.3);
            color: #ffd54f;
            border-color: #ffc107;
        }

        .detail-modal-close {
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 50%;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }

        .detail-modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 25px 30px;
        }

        /* è¯¦æƒ…æ—¶é—´çº¿ */
        .detail-timeline {
            position: relative;
            padding-left: 40px;
        }

        .detail-timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #8b7355, #5a4a3a);
        }

        .detail-event {
            position: relative;
            margin-bottom: 25px;
            padding: 15px 20px;
            background: rgba(30,25,20,0.8);
            border: 1px solid #3a2a20;
            border-radius: 5px;
        }

        .detail-event::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4caf50;
            border: 2px solid #6fcf70;
        }

        .detail-event.story::before {
            background: #e85a5a;
            border-color: #ff7a7a;
        }

        .detail-event.video::before {
            background: #9a5ae8;
            border-color: #ba7aff;
        }

        .detail-event.pending::before {
            background: #3a2a20;
            border-color: #5a4a3a;
        }

        .detail-event h4 {
            color: #c9a86c;
            font-size: 1.05em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-event h4 .tag {
            font-size: 0.7em;
            padding: 3px 10px;
            border-radius: 3px;
        }

        .detail-event h4 .tag.story {
            background: rgba(232,90,90,0.2);
            color: #e85a5a;
            border: 1px solid #e85a5a;
        }

        .detail-event h4 .tag.video {
            background: rgba(154,90,232,0.2);
            color: #9a5ae8;
            border: 1px solid #9a5ae8;
        }

        .detail-event p {
            color: #8b7a6a;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .detail-event .video-btn {
            margin-top: 12px;
            padding: 8px 20px;
            background: linear-gradient(180deg, #5a3a8a, #3a2a5a);
            border: 1px solid #9a5ae8;
            color: #ba7aff;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .detail-event .video-btn:hover {
            background: linear-gradient(180deg, #6a4a9a, #4a3a6a);
        }

        .detail-modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #3a2a20;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .detail-modal-footer .btn {
            padding: 12px 30px;
            border-radius: 5px;
            font-family: 'Noto Serif SC', serif;
            cursor: pointer;
            font-size: 0.95em;
        }

        .detail-modal-footer .btn-replay {
            background: linear-gradient(180deg, #8B2323, #5a1515);
            color: #fff;
            border: 2px solid #aa4040;
        }

        .detail-modal-footer .btn-replay:hover {
            background: linear-gradient(180deg, #9B3333, #6a2525);
        }

        .detail-modal-footer .btn-replay:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .detail-modal-footer .btn-close {
            background: linear-gradient(180deg, #3a3025, #252015);
            color: #c9a86c;
            border: 1px solid #5a4a3a;
        }

        /* ==================== ç­–åˆ’æ¡ˆå¼¹çª— ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            background: linear-gradient(180deg, #1a1815 0%, #0f0c0a 100%);
            border: 2px solid #8b7355;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            background: linear-gradient(90deg, #8b7355, #5a4a3a);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.4em;
            color: #1a1510;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 50%;
            color: #1a1510;
            font-size: 1.5em;
            cursor: pointer;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        /* ç­–åˆ’æ¡ˆæ ·å¼ */
        .doc-section {
            margin-bottom: 35px;
        }

        .doc-section h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.2em;
            color: #d4af37;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #5a4a3a;
        }

        .doc-section h4 {
            font-size: 1em;
            color: #c9a86c;
            margin: 15px 0 10px;
        }

        .doc-section p, .doc-section li {
            color: #a09080;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .doc-section ul {
            margin-left: 20px;
        }

        .doc-section strong {
            color: #e8e4d9;
        }

        .doc-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .doc-table th {
            background: rgba(139,115,85,0.3);
            color: #d4af37;
            padding: 12px;
            text-align: left;
            border: 1px solid #5a4a3a;
            font-size: 0.9em;
        }

        .doc-table td {
            padding: 12px;
            border: 1px solid #3a2a20;
            color: #a09080;
            font-size: 0.85em;
        }

        .highlight-box {
            background: rgba(212,175,55,0.1);
            border: 1px solid #d4af37;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .highlight-box h5 {
            color: #d4af37;
            margin-bottom: 8px;
        }

        .highlight-box p {
            color: #c9a86c;
            margin: 0;
        }

        .flow-diagram {
            background: rgba(30,25,20,0.8);
            border: 1px solid #5a4a3a;
            border-radius: 5px;
            padding: 25px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .flow-step {
            background: linear-gradient(180deg, #3a3025, #252015);
            border: 2px solid #5a4a3a;
            border-radius: 5px;
            padding: 12px 20px;
            text-align: center;
        }

        .flow-step.highlight {
            border-color: #d4af37;
        }

        .flow-step .num {
            font-size: 0.7em;
            color: #8b7355;
        }

        .flow-step .text {
            color: #e8e4d9;
            font-size: 0.9em;
        }

        .flow-arrow {
            color: #5a4a3a;
            font-size: 1.2em;
        }

        .code-block {
            background: #0a0908;
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.8em;
            color: #a09080;
            overflow-x: auto;
            margin: 10px 0;
        }

        .code-block .key { color: #5a9ae8; }
        .code-block .value { color: #e85a5a; }
        .code-block .string { color: #9ae85a; }
        .code-block .comment { color: #666; }

        /* ==================== ç« èŠ‚é€‰æ‹©ç•Œé¢ (CHAPTER SELECT) ==================== */
        .chapter-select-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0808;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .chapter-select-screen.hidden {
            display: none;
        }

        /* åŸå¸‚å¤©é™…çº¿èƒŒæ™¯ */
        .skyline-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(to top, #1a1a1a 0%, transparent 100%);
            opacity: 0.6;
        }

        .skyline-bg::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background:
                linear-gradient(90deg,
                    transparent 0%, #222 2%, #222 3%, transparent 3.5%,
                    transparent 8%, #1a1a1a 8.5%, #1a1a1a 10%, transparent 10.5%,
                    transparent 15%, #252525 15.5%, #252525 18%, transparent 18.5%,
                    transparent 25%, #1f1f1f 25.5%, #1f1f1f 27%, transparent 27.5%,
                    transparent 35%, #222 35.5%, #222 38%, transparent 38.5%,
                    transparent 45%, #1a1a1a 45.5%, #1a1a1a 48%, transparent 48.5%,
                    transparent 55%, #252525 55.5%, #252525 58%, transparent 58.5%,
                    transparent 65%, #1f1f1f 65.5%, #1f1f1f 68%, transparent 68.5%,
                    transparent 75%, #222 75.5%, #222 78%, transparent 78.5%,
                    transparent 85%, #1a1a1a 85.5%, #1a1a1a 88%, transparent 88.5%,
                    transparent 95%, #252525 95.5%, #252525 98%, transparent 100%
                );
            background-size: 100% 100%;
        }

        /* æ ‡é¢˜ */
        .chapter-select-title {
            font-family: 'Cinzel', serif;
            font-size: 2.2em;
            color: #e8e4d9;
            letter-spacing: 8px;
            margin-bottom: 60px;
            text-transform: uppercase;
            z-index: 1;
        }

        /* å¡ç‰‡å®¹å™¨ */
        .chapter-cards-container {
            display: flex;
            gap: 40px;
            z-index: 1;
            align-items: flex-end;
        }

        /* ç« èŠ‚å¡ç‰‡åŸºç¡€æ ·å¼ */
        .chapter-card {
            width: 220px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }

        .chapter-card:hover {
            transform: translateY(-12px);
            filter: brightness(1.05);
        }

        .chapter-card.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .chapter-card.locked:hover {
            transform: none;
            filter: none;
        }

        /* æŠ¥çº¸å¡ç‰‡æ ·å¼ - å·²å®Œæˆç« èŠ‚ */
        .newspaper-card {
            background: #f5f0e1;
            padding: 15px;
            border-radius: 2px;
            box-shadow:
                5px 5px 20px rgba(0,0,0,0.5),
                0 0 0 1px rgba(0,0,0,0.1);
            transform: rotate(-2deg);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .newspaper-card:hover {
            transform: rotate(-2deg) translateY(-12px);
            box-shadow:
                8px 12px 30px rgba(0,0,0,0.6),
                0 0 20px rgba(212,175,55,0.2);
        }

        .newspaper-inner {
            border: 1px solid #8a7a6a;
            padding: 10px;
        }

        .newspaper-header {
            font-family: 'Special Elite', cursive;
            font-size: 0.6em;
            color: #4a4a4a;
            text-align: center;
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }

        .newspaper-title {
            font-family: 'Cinzel', serif;
            font-size: 1.1em;
            color: #1a1a1a;
            text-align: center;
            font-weight: bold;
            line-height: 1.3;
            margin-bottom: 10px;
        }

        .newspaper-image {
            width: 100%;
            height: 100px;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            color: #666;
            margin-bottom: 10px;
        }

        .newspaper-date {
            font-family: 'Special Elite', cursive;
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        /* æ‹ç«‹å¾—å¡ç‰‡æ ·å¼ - è¿›è¡Œä¸­/æœªè§£é”ç« èŠ‚ */
        .polaroid-card {
            background: #f8f6f0;
            padding: 12px 12px 40px 12px;
            border-radius: 2px;
            box-shadow:
                5px 5px 20px rgba(0,0,0,0.5),
                0 0 0 1px rgba(0,0,0,0.05);
            transform: rotate(2deg);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .polaroid-card:hover {
            transform: rotate(2deg) translateY(-12px);
            box-shadow:
                8px 12px 30px rgba(0,0,0,0.6),
                0 0 20px rgba(255,193,7,0.2);
        }

        .polaroid-card.locked:hover {
            transform: rotate(2deg);
            box-shadow: 5px 5px 20px rgba(0,0,0,0.5);
        }

        .polaroid-image {
            width: 100%;
            height: 160px;
            background: linear-gradient(135deg, #2a1a15 0%, #1a0a05 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .polaroid-image.fire-scene {
            background: linear-gradient(to top, #1a0a05, #3a1a10, #5a2a15);
        }

        .polaroid-image.fire-scene::before {
            content: 'ğŸ”¥';
            font-size: 4em;
            opacity: 0.8;
        }

        .polaroid-image.locked-scene {
            background: #1a1a1a;
        }

        .polaroid-image.locked-scene::after {
            content: '???';
            font-family: 'Cinzel', serif;
            font-size: 2em;
            color: #4a4a4a;
        }

        .polaroid-caption {
            font-family: 'Special Elite', cursive;
            font-size: 0.85em;
            color: #333;
            text-align: center;
            margin-top: 12px;
        }

        /* å¡ç‰‡åº•éƒ¨ä¿¡æ¯æ¡ */
        .chapter-info-bar {
            position: absolute;
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            padding: 10px 15px;
            text-align: center;
            border-radius: 3px;
        }

        .chapter-info-bar.completed {
            background: linear-gradient(180deg, #6B1C1C, #4a1515);
            border: 1px solid #8a3030;
        }

        .chapter-info-bar.in-progress {
            background: linear-gradient(180deg, #8B2323, #5a1515);
            border: 1px solid #aa4040;
        }

        .chapter-info-bar.locked {
            background: linear-gradient(180deg, #3a3a3a, #2a2a2a);
            border: 1px solid #4a4a4a;
        }

        .chapter-info-bar .chapter-number {
            font-family: 'Cinzel', serif;
            font-size: 0.9em;
            color: #e8e4d9;
            font-weight: bold;
        }

        .chapter-info-bar .chapter-name {
            font-size: 0.75em;
            color: #c9a86c;
            margin-top: 2px;
        }

        .chapter-info-bar .chapter-status {
            font-family: 'Cinzel', serif;
            font-size: 0.65em;
            color: #8a7a6a;
            margin-top: 5px;
            letter-spacing: 2px;
        }

        /* ç« èŠ‚åˆ‡æ¢å°æŒ‰é’® - æ”¾åœ¨UNITæ ‡é¢˜æ—è¾¹ */
        .chapter-switch-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: rgba(139,35,35,0.3);
            border: 1px solid #8B2323;
            color: #c9a86c;
            font-family: 'Cinzel', serif;
            font-size: 0.65em;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s ease;
            margin-left: 10px;
            vertical-align: middle;
        }

        .chapter-switch-btn:hover {
            background: rgba(139,35,35,0.5);
            border-color: #d4af37;
            color: #d4af37;
        }

        .chapter-switch-btn:focus {
            outline: none;
        }

        .chapter-switch-btn .arrow {
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯åœºæ™¯ -->
    <div class="scene-background"></div>
    <div class="noise-overlay"></div>

    <!-- çº¢è‰²åœ†åœˆè£…é¥° -->
    <div class="red-circle red-circle-1" style="position:fixed;width:120px;height:120px;bottom:18%;left:48%;border:2px solid rgba(139,35,35,0.2);border-radius:50%;pointer-events:none;z-index:5;"></div>
    <div class="red-circle red-circle-2" style="position:fixed;width:60px;height:60px;top:62%;right:8%;border:2px solid rgba(139,35,35,0.15);border-radius:50%;pointer-events:none;z-index:5;"></div>

    <!-- ==================== ç« èŠ‚é€‰æ‹©ç•Œé¢ (CHAPTER SELECT) - é»˜è®¤éšè— ==================== -->
    <div class="chapter-select-screen" id="chapterSelectScreen" style="display:none;">
        <div class="skyline-bg"></div>

        <h1 class="chapter-select-title">Chapter Select</h1>

        <div class="chapter-cards-container">
            <!-- ç« èŠ‚1 - å·²å®Œæˆ - æŠ¥çº¸é£æ ¼ -->
            <div class="chapter-card" onclick="enterChapterReview(1)">
                <div class="newspaper-card">
                    <div class="newspaper-inner">
                        <div class="newspaper-header">Chicago Daily Tribune</div>
                        <div class="newspaper-title">BLUE MOON<br>ACCIDENT</div>
                        <div class="newspaper-image">ğŸ“°</div>
                        <div class="newspaper-date">November 12, 1925</div>
                    </div>
                </div>
                <div class="chapter-info-bar completed">
                    <div class="chapter-number">NO.1</div>
                    <div class="chapter-name">è“æœˆäº‹ä»¶</div>
                    <div class="chapter-status">âœ“ COMPLETED</div>
                </div>
            </div>

            <!-- ç« èŠ‚2 - è¿›è¡Œä¸­ - æ‹ç«‹å¾—é£æ ¼ -->
            <div class="chapter-card" onclick="enterChapterReview(2)">
                <div class="polaroid-card">
                    <div class="polaroid-image fire-scene"></div>
                    <div class="polaroid-caption">Chicago - Nov 14, 1925</div>
                </div>
                <div class="chapter-info-bar in-progress">
                    <div class="chapter-number">NO.2</div>
                    <div class="chapter-name">TWILIGHT ELEGY</div>
                    <div class="chapter-status">â— IN PROGRESS</div>
                </div>
            </div>

            <!-- ç« èŠ‚3 - æœªè§£é” - æ‹ç«‹å¾—é£æ ¼ï¼ˆæ¨¡ç³Šï¼‰ -->
            <div class="chapter-card locked">
                <div class="polaroid-card">
                    <div class="polaroid-image locked-scene"></div>
                    <div class="polaroid-caption">&nbsp;</div>
                </div>
                <div class="chapter-info-bar locked">
                    <div class="chapter-number">NO.3</div>
                    <div class="chapter-name">???</div>
                    <div class="chapter-status">COMING SOON</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== æ¡ˆæƒ…å›é¡¾ä¸»ç•Œé¢ - é»˜è®¤æ˜¾ç¤º ==================== -->
    <div class="main-container" id="mainContainer">
        <!-- å·¦ä¾§ - æ¡ˆä»¶æ¡£æ¡ˆå¡ç‰‡ -->
        <div class="left-panel">
            <div class="chapter-header">
                <h2>UNIT 2 <button class="chapter-switch-btn" id="chapterSwitchBtn" onclick="backToChapterSelect()"><span class="arrow">â—€</span> åˆ‡æ¢</button></h2>
                <div class="subtitle">Frank Kowalski ä¹‹æ­»</div>
                <!-- å°ç« è£…é¥° -->
                <div class="stamp-decoration">
                    <span>CASE<br>FILE</span>
                </div>
            </div>

            <div class="case-file-area">
                <div class="case-file active" onclick="selectLoop(1)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">æ®‹é…·çš„èº«ä»½ç¡®è®¤</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Morrison</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(2)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Leonard Ross</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(3)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">æ å¤ºæ€§è´·æ¬¾æ­éœ²</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Harold Moore</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(4)">
                    <div class="file-header">
                        <div>
                            <div class="case-name hidden-name">???</div>
                        </div>
                        <span class="status-badge current">è¿›è¡Œä¸­</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="hidden">???</span>
                    </div>
                    <div class="stamp-overlay progress">IN PROGRESS</div>
                </div>
            </div>
        </div>

        <!-- ä¸­é—´ - å‚ç›´æ—¶é—´çº¿ -->
        <div class="center-panel">
            <div class="panel-header">
                <div class="panel-title">
                    <h1>PROGRESS</h1>
                    <span class="cn">æ¡ˆæƒ…è¿›å±•</span>
                </div>
                <button class="close-btn" onclick="goBack()">è¿”å›</button>
            </div>

            <div class="timeline-container">
                <div class="vertical-timeline">
                    <!-- æ®‹é…·çš„èº«ä»½ç¡®è®¤ -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">æ®‹é…·çš„èº«ä»½ç¡®è®¤</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(1)">
                                <h4>
                                    <span class="title-text">ç¡®è®¤æ­»è€…èº«ä»½ï¼Œæ­éœ²Morrisonçš„è°è¨€</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨ -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(2)">
                                <h4>
                                    <span class="title-text">è¿½æŸ¥è¿å·é’ç¥¨ï¼Œæ­éœ²æš´åŠ›å‚¬å€º</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- æ å¤ºæ€§è´·æ¬¾æ­éœ² -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">æ å¤ºæ€§è´·æ¬¾æ­éœ²</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(3)">
                                <h4>
                                    <span class="title-text">æ­éœ²é“¶è¡Œè´·æ¬¾æ¬ºè¯ˆï¼Œè·å¾—é—å˜±å‰¯æœ¬</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- Roseæ·±æƒ…å‘Šç™½ (å½“å‰) -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker current">â—</div>
                            <div class="loop-title">Roseæ·±æƒ…å‘Šç™½</div>
                        </div>

                        <div class="event-node">
                            <div class="event-content" onclick="openDetail(4)">
                                <h4>
                                    <span class="title-text">è°ƒæŸ¥é—å˜±äº‰è®®ä¸çº¦ä¼šæˆ¿é—´</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å³ä¾§ - æ“ä½œ -->
        <div class="right-panel">
            <div class="action-area">
                <button class="action-btn doc" onclick="openDoc()">
                    ğŸ“‹ ç­–åˆ’æ¡ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <div class="detail-modal" id="detailModal">
        <div class="detail-modal-content">
            <div class="detail-modal-header">
                <h2 id="detailTitle">æ®‹é…·çš„èº«ä»½ç¡®è®¤</h2>
                <span class="status-tag" id="detailStatus">å·²å®Œæˆ</span>
            </div>
            <div class="detail-modal-body">
                <div class="detail-timeline" id="detailTimeline">
                    <!-- åŠ¨æ€å¡«å…… -->
                </div>
            </div>
            <div class="detail-modal-footer">
                <button class="btn btn-close" onclick="closeDetail()">è¿”å›</button>
                <button class="btn btn-replay" id="detailReplayBtn" onclick="replayFromDetail()">âª å›æº¯è‡³æ­¤</button>
            </div>
        </div>
    </div>

    <!-- ç­–åˆ’æ¡ˆå¼¹çª— -->
    <div class="modal-overlay" id="docModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“‹ æ¡ˆæƒ…å›é¡¾ç³»ç»Ÿ - ç­–åˆ’æ¡ˆ</h2>
                <button class="modal-close" onclick="closeDoc()">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- ç³»ç»Ÿæ¦‚è¿° -->
                <div class="doc-section">
                    <h3>ä¸€ã€ç³»ç»Ÿæ¦‚è¿°</h3>
                    <p><strong>ç³»ç»Ÿåç§°</strong>ï¼šæ¡ˆæƒ…å›é¡¾ç³»ç»Ÿï¼ˆOVERVIEWï¼‰</p>
                    <p><strong>ç³»ç»Ÿå®šä½</strong>ï¼šNDCæ ¸å¿ƒé¢æ¿ä¹‹ä¸€ï¼Œæä¾›ç©å®¶å›é¡¾æ¡ˆä»¶è¿›å±•ã€é‡æ–°æ’­æ”¾å‰§æƒ…è§†é¢‘ã€å›æº¯åˆ°æŒ‡å®šèŠ‚ç‚¹é‡æ–°å¼€å§‹çš„åŠŸèƒ½ã€‚</p>

                    <div class="highlight-box">
                        <h5>ğŸ’¡ æ ¸å¿ƒè®¾è®¡ç†å¿µ</h5>
                        <p>ã€Œå¾ªç¯å³å­˜æ¡£ç‚¹ã€- æ¯ä¸ªå¾ªç¯çš„ç»“æŸè‡ªåŠ¨ä¿å­˜è¿›åº¦ã€‚ç©å®¶å¯ä»¥éšæ—¶å›æº¯åˆ°ä»»æ„å·²å®Œæˆå¾ªç¯çš„èµ·ç‚¹é‡æ–°å¼€å§‹æ¸¸æˆï¼Œæ¢ç´¢ä¸åŒé€‰æ‹©å¸¦æ¥çš„ä¸åŒç»“æœã€‚</p>
                    </div>

                    <h4>1.1 ç³»ç»ŸåŠŸèƒ½</h4>
                    <ul>
                        <li><strong>æ¡ˆæƒ…å›é¡¾</strong>ï¼šæŸ¥çœ‹æ‰€æœ‰å·²è§£é”ç« èŠ‚çš„æ•…äº‹èƒŒæ™¯å’Œè¿›åº¦</li>
                        <li><strong>ç« èŠ‚åˆ‡æ¢</strong>ï¼šåœ¨ä¸åŒç« èŠ‚ä¹‹é—´åˆ‡æ¢æŸ¥çœ‹</li>
                        <li><strong>èŠ‚ç‚¹å›æº¯</strong>ï¼šå›åˆ°æŸä¸ªå¾ªç¯èµ·ç‚¹ï¼Œä»è¯¥èŠ‚ç‚¹é‡æ–°å¼€å§‹æ¸¸æˆ</li>
                        <li><strong>è¿›åº¦å±•ç¤º</strong>ï¼šç›´è§‚å±•ç¤ºç©å®¶åœ¨æ¯ä¸ªå¾ªç¯çš„è¿›å±•çŠ¶æ€</li>
                    </ul>
                </div>

                <!-- å­˜æ¡£è§„åˆ™ -->
                <div class="doc-section">
                    <h3>äºŒã€å­˜æ¡£è§„åˆ™</h3>

                    <h4>2.1 å­˜æ¡£è§¦å‘æ—¶æœº</h4>
                    <table class="doc-table">
                        <tr>
                            <th>è§¦å‘æ¡ä»¶</th>
                            <th>å­˜æ¡£ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td>å¾ªç¯ç»“æŸï¼ˆæŒ‡è¯æˆåŠŸï¼‰</td>
                            <td>å¾ªç¯å­˜æ¡£</td>
                            <td><strong>è‡ªåŠ¨è§¦å‘ï¼Œä¸å¯è·³è¿‡</strong></td>
                        </tr>
                        <tr>
                            <td>ç« èŠ‚ç»“æŸ</td>
                            <td>ç« èŠ‚å­˜æ¡£</td>
                            <td>ç‰¹æ®Šæ ‡è®°ï¼ŒåŒ…å«å®Œæ•´ç« èŠ‚æ•°æ®</td>
                        </tr>
                    </table>

                    <div class="highlight-box">
                        <h5>âš ï¸ é‡è¦é™åˆ¶</h5>
                        <p><strong>ä¸æ”¯æŒä¸­é€”å­˜æ¡£</strong>ï¼šç©å®¶æ— æ³•åœ¨å¾ªç¯è¿›è¡Œä¸­æ‰‹åŠ¨ä¿å­˜ï¼Œåªèƒ½åœ¨å¾ªç¯ç»“æŸæ—¶è‡ªåŠ¨ä¿å­˜ã€‚</p>
                    </div>

                    <h4>2.2 å­˜æ¡£æ•°æ®å†…å®¹</h4>
                    <table class="doc-table">
                        <tr>
                            <th>æ•°æ®ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td>å·²è·å¾—è¯æ®ï¼ˆEvidenceï¼‰</td>
                            <td>ITEMSã€CLUESã€NOTESã€COMBINED</td>
                        </tr>
                        <tr>
                            <td>å·²è§£é”åœºæ™¯</td>
                            <td>å¯å‰å¾€çš„åœ°ç‚¹åˆ—è¡¨</td>
                        </tr>
                        <tr>
                            <td>å·²å®Œæˆå¯¹è¯</td>
                            <td>NPCå¯¹è¯è®°å½•å’Œæå–çš„å…³é”®ä¿¡æ¯</td>
                        </tr>
                        <tr>
                            <td>å‰§æƒ…æ ‡è®°ï¼ˆFlagsï¼‰</td>
                            <td>å·²è§¦å‘çš„äº‹ä»¶å’Œè§£é”æ¡ä»¶</td>
                        </tr>
                        <tr>
                            <td>å¾ªç¯å®ŒæˆçŠ¶æ€</td>
                            <td>è¯¥å¾ªç¯æ˜¯å¦å·²å®Œæˆ</td>
                        </tr>
                    </table>

                    <h4>2.3 å­˜æ¡£æ•°æ®ç»“æ„ç¤ºä¾‹</h4>
                    <div class="code-block">
{
  <span class="key">"loop_id"</span>: <span class="value">1</span>,
  <span class="key">"loop_name"</span>: <span class="string">"æ®‹é…·çš„èº«ä»½ç¡®è®¤"</span>,
  <span class="key">"status"</span>: <span class="string">"completed"</span>,
  <span class="key">"player_data"</span>: {
    <span class="key">"evidence_ids"</span>: [<span class="string">"EV101"</span>, <span class="string">"EV102"</span>, <span class="string">"EV103"</span>],
    <span class="key">"unlocked_scenes"</span>: [<span class="string">"SC201"</span>, <span class="string">"SC202"</span>],
    <span class="key">"completed_dialogues"</span>: [<span class="string">"D201"</span>, <span class="string">"D202"</span>],
    <span class="key">"flags"</span>: {
      <span class="string">"morrison_exposed"</span>: <span class="value">true</span>,
      <span class="string">"frank_identity_confirmed"</span>: <span class="value">true</span>
    }
  }
}
                    </div>
                </div>

                <!-- é‡ç©æœºåˆ¶ -->
                <div class="doc-section">
                    <h3>ä¸‰ã€é‡ç©ï¼ˆå›æº¯ï¼‰æœºåˆ¶</h3>

                    <h4>3.1 å›æº¯æµç¨‹</h4>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="num">STEP 1</div>
                            <div class="text">æ‰“å¼€OVERVIEW</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 2</div>
                            <div class="text">é€‰æ‹©ç›®æ ‡å¾ªç¯</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step highlight">
                            <div class="num">STEP 3</div>
                            <div class="text">ç‚¹å‡»ã€Œé‡ç©ã€</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 4</div>
                            <div class="text">ç¡®è®¤æç¤º</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 5</div>
                            <div class="text">åŠ è½½å¾ªç¯èµ·ç‚¹</div>
                        </div>
                    </div>

                    <h4>3.2 å›æº¯è§„åˆ™</h4>
                    <table class="doc-table">
                        <tr>
                            <th>æ•°æ®ç±»å‹</th>
                            <th>å›æº¯æ—¶å¤„ç†</th>
                        </tr>
                        <tr>
                            <td>è¯æ®</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å·²è§£é”åœºæ™¯</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å¯¹è¯è®°å½•</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å‰§æƒ…æ ‡è®°</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                    </table>

                    <div class="highlight-box">
                        <h5>ğŸ’¡ å›æº¯æ„ä¹‰</h5>
                        <p>AVGå¯¹è¯å†…å®¹å¯èƒ½å› ä¸åŒé€‰æ‹©è€Œä¸åŒï¼Œè·å¾—çš„çº¿ç´¢ä¹Ÿå¯èƒ½ä¸åŒã€‚å›æº¯æœºåˆ¶è®©ç©å®¶å¯ä»¥æ¢ç´¢ä¸åŒçš„é€‰æ‹©è·¯å¾„ã€‚</p>
                    </div>
                </div>

                <!-- UIè®¾è®¡ -->
                <div class="doc-section">
                    <h3>å››ã€UIç•Œé¢è®¾è®¡</h3>

                    <h4>4.1 ç•Œé¢å¸ƒå±€</h4>
                    <table class="doc-table">
                        <tr>
                            <th>åŒºåŸŸ</th>
                            <th>å†…å®¹</th>
                            <th>åŠŸèƒ½</th>
                        </tr>
                        <tr>
                            <td>å·¦ä¾§é¢æ¿</td>
                            <td>å¾ªç¯æ¡£æ¡ˆå¡ç‰‡</td>
                            <td>å±•ç¤ºæ‰€æœ‰å¾ªç¯çŠ¶æ€ï¼Œç‚¹å‡»åˆ‡æ¢é€‰ä¸­</td>
                        </tr>
                        <tr>
                            <td>ä¸­é—´é¢æ¿</td>
                            <td>å‚ç›´æ—¶é—´çº¿</td>
                            <td>ä¸Šä¸‹æ»šåŠ¨æŸ¥çœ‹å„å¾ªç¯çš„äº‹ä»¶èŠ‚ç‚¹</td>
                        </tr>
                        <tr>
                            <td>å³ä¾§é¢æ¿</td>
                            <td>è¯¦æƒ…ä¸æ“ä½œ</td>
                            <td>æ˜¾ç¤ºé€‰ä¸­å¾ªç¯ä¿¡æ¯ï¼Œæä¾›é‡ç©æŒ‰é’®</td>
                        </tr>
                    </table>

                    <h4>4.2 å¾ªç¯å¡ç‰‡çŠ¶æ€</h4>
                    <ul>
                        <li><strong style="color:#4caf50">å·²å®Œæˆï¼ˆSOLVEDï¼‰</strong>ï¼šæ˜¾ç¤ºæŒ‡è¯å¯¹è±¡ï¼Œå¯æŸ¥çœ‹</li>
                        <li><strong style="color:#ffc107">è¿›è¡Œä¸­ï¼ˆIN PROGRESSï¼‰</strong>ï¼šæŒ‡è¯å¯¹è±¡æ˜¾ç¤ºä¸ºã€Œ???ã€ï¼Œä¸å¯æŸ¥çœ‹</li>
                    </ul>

                    <h4>4.3 æ—¶é—´çº¿èŠ‚ç‚¹ç±»å‹</h4>
                    <ul>
                        <li><strong style="color:#e85a5a">å‰§æƒ…èŠ‚ç‚¹ï¼ˆçº¢è‰²ï¼‰</strong>ï¼šå…³é”®å‰§æƒ…ç‚¹ï¼Œè‡ªåŠ¨æ’­æ”¾çš„æ•…äº‹å†…å®¹</li>
                        <li><strong>æ™®é€šèŠ‚ç‚¹</strong>ï¼šæœè¯é˜¶æ®µç­‰å¯äº¤äº’å†…å®¹</li>
                        <li><strong style="color:#9a5ae8">æŒ‡è¯èŠ‚ç‚¹ï¼ˆç´«è‰²ï¼‰</strong>ï¼šæŒ‡è¯æ¼”å‡º</li>
                    </ul>
                </div>

                <!-- é™æ€é…ç½® -->
                <div class="doc-section">
                    <h3>äº”ã€é™æ€é…ç½® (Config)</h3>
                    <p>å¼€å‘æ—¶å®šä¹‰çš„å›ºå®šæ•°æ®ï¼Œä¸éšç©å®¶è¡Œä¸ºæ”¹å˜ï¼š</p>

                    <pre style="background:#1a1a2e; padding:15px; border-radius:8px; overflow-x:auto; font-size:13px;">
{
  "loopConfig": [
    {
      "loopId": 1,
      "loopName": "æ®‹é…·çš„èº«ä»½ç¡®è®¤",
      "accuseTargetId": "NPC104",
      "accuseTargetName": "Morrison",
      "accuseRounds": 2
    },
    {
      "loopId": 2,
      "loopName": "å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨",
      "accuseTargetId": "NPC201",
      "accuseTargetName": "Leonard Ross",
      "accuseRounds": 3
    }
    // ... Loop 3-6 åŒç†
  ]
}
                    </pre>

                    <table class="doc-table">
                        <tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr>
                        <tr><td>loopId</td><td>number</td><td>å¾ªç¯åºå· (1-6)</td></tr>
                        <tr><td>loopName</td><td>string</td><td>å¾ªç¯åç§°</td></tr>
                        <tr><td>accuseTargetId</td><td>string</td><td>æŒ‡è¯å¯¹è±¡NPC ID</td></tr>
                        <tr><td>accuseTargetName</td><td>string</td><td>æŒ‡è¯å¯¹è±¡æ˜¾ç¤ºåç§°</td></tr>
                        <tr><td>accuseRounds</td><td>number</td><td>éœ€è¦çš„æŒ‡è¯è½®æ¬¡</td></tr>
                    </table>
                </div>

                <!-- å­˜æ¡£æ•°æ® -->
                <div class="doc-section">
                    <h3>å…­ã€å­˜æ¡£æ•°æ® (Save Data)</h3>
                    <p>ç©å®¶æ¸¸ç©è¿‡ç¨‹ä¸­åŠ¨æ€äº§ç”Ÿçš„æ•°æ®ï¼š</p>

                    <pre style="background:#1a1a2e; padding:15px; border-radius:8px; overflow-x:auto; font-size:13px;">
{
  "currentLoop": 3,
  "loopSaveData": [
    {
      "loopId": 1,
      "isUnlocked": true,
      "isCompleted": true,
      "savedEvidence": ["EV001", "EV002"],
      "savedScenes": ["SC001", "SC002"],
      "savedDialogues": ["DL001"],
      "accuseResult": "success",
      "savedTimestamp": 1733000000000
    }
  ]
}
                    </pre>

                    <table class="doc-table">
                        <tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr>
                        <tr><td>currentLoop</td><td>number</td><td>ç©å®¶å½“å‰æ‰€åœ¨å¾ªç¯</td></tr>
                        <tr><td>loopId</td><td>number</td><td>å¾ªç¯åºå·</td></tr>
                        <tr><td>isUnlocked</td><td>boolean</td><td>æ˜¯å¦è§£é”ï¼ˆå¯æŸ¥çœ‹ï¼‰</td></tr>
                        <tr><td>isCompleted</td><td>boolean</td><td>æ˜¯å¦å·²å®Œæˆ</td></tr>
                        <tr><td>savedEvidence</td><td>string[]</td><td>å·²æ”¶é›†è¯æ®IDåˆ—è¡¨</td></tr>
                        <tr><td>savedScenes</td><td>string[]</td><td>å·²è§£é”åœºæ™¯IDåˆ—è¡¨</td></tr>
                        <tr><td>savedDialogues</td><td>string[]</td><td>å·²è§¦å‘å¯¹è¯IDåˆ—è¡¨</td></tr>
                        <tr><td>accuseResult</td><td>string</td><td>"success" | "failed" | null</td></tr>
                        <tr><td>savedTimestamp</td><td>number</td><td>å­˜æ¡£æ—¶é—´æˆ³</td></tr>
                    </table>
                </div>

                <!-- ä¸å…¶ä»–ç³»ç»Ÿçš„å…³ç³» -->
                <div class="doc-section">
                    <h3>ä¸ƒã€ä¸å…¶ä»–ç³»ç»Ÿçš„å…³ç³»</h3>

                    <h4>7.1 å…¥å£è§„åˆ™</h4>
                    <ul>
                        <li><strong>ç‚¹å‡»OVERVIEWæŒ‰é’®</strong> â†’ ç›´æ¥è¿›å…¥<strong>å½“å‰ç« èŠ‚</strong>çš„æ¡ˆæƒ…è¿›å±•ç•Œé¢</li>
                        <li><strong>ç‚¹å‡»â† CHAPTER SELECT</strong> â†’ ä»æ¡ˆæƒ…è¿›å±•ç•Œé¢è¿›å…¥ç« èŠ‚é€‰æ‹©ç•Œé¢ï¼ˆç”¨äºè·¨ç« èŠ‚å›æº¯ï¼‰</li>
                    </ul>

                    <h4>7.2 æ•°æ®æ¥æº</h4>
                    <ul>
                        <li><strong>Evidenceæ•°æ®</strong>ï¼šæ¥è‡ªCASE BOARDé¢æ¿ä¸­çš„ITEMSã€CLUESã€NOTESã€COMBINED</li>
                        <li><strong>Sceneæ•°æ®</strong>ï¼šæ¥è‡ªMAPåœ°å›¾é¢æ¿ä¸­å·²è§£é”çš„åœºæ™¯</li>
                        <li><strong>Dialogueæ•°æ®</strong>ï¼šæ¥è‡ªNPCå¯¹è¯çš„AVGè®°å½•</li>
                    </ul>

                    <h4>7.3 è§¦å‘æ—¶æœº</h4>
                    <p>å¾ªç¯ç»“æŸåï¼ˆæŒ‡è¯æˆåŠŸï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨ä¿å­˜å½“å‰çŠ¶æ€åˆ°å¯¹åº”å¾ªç¯çš„å­˜æ¡£ä¸­ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== ç•Œé¢åˆ‡æ¢å‡½æ•° ====================
        // å…¥å£è§„åˆ™ï¼š
        // - ä»å¼€å§‹ç•Œé¢ç‚¹å‡» CHAPTER SELECT â†’ å…ˆæ˜¾ç¤ºç« èŠ‚é€‰æ‹©ç•Œé¢ï¼ˆå¸¦ ?mode=select å‚æ•°ï¼‰
        // - ä»æ¸¸æˆä¸­ç‚¹å‡» OVERVIEW â†’ ç›´æ¥è¿›å…¥å½“å‰ç« èŠ‚çš„æ¡ˆæƒ…è¿›å±•ç•Œé¢ï¼ˆæ— å‚æ•°æˆ– ?mode=overviewï¼‰
        // - åœ¨æ¡ˆæƒ…è¿›å±•ç•Œé¢ç‚¹å‡» â† CHAPTER SELECT â†’ è¿”å›ç« èŠ‚é€‰æ‹©ç•Œé¢

        // é¡µé¢åŠ è½½æ—¶æ£€æµ‹å…¥å£æ¨¡å¼
        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');

            if (mode === 'select') {
                // ä»å¼€å§‹ç•Œé¢çš„CHAPTER SELECTè¿›å…¥ â†’ æ˜¾ç¤ºç« èŠ‚é€‰æ‹©ç•Œé¢
                document.getElementById('chapterSelectScreen').style.display = 'flex';
                document.getElementById('mainContainer').style.display = 'none';
            } else {
                // ä»æ¸¸æˆä¸­çš„OVERVIEWè¿›å…¥ â†’ æ˜¾ç¤ºå½“å‰ç« èŠ‚çš„æ¡ˆæƒ…è¿›å±•ç•Œé¢
                document.getElementById('chapterSelectScreen').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'flex';
            }
        });

        // ä»ç« èŠ‚é€‰æ‹©ç•Œé¢è¿›å…¥æ¡ˆæƒ…å›é¡¾
        function enterChapterReview(chapterId) {
            // éšè—ç« èŠ‚é€‰æ‹©ç•Œé¢
            document.getElementById('chapterSelectScreen').style.display = 'none';
            // æ˜¾ç¤ºæ¡ˆæƒ…å›é¡¾ä¸»ç•Œé¢
            document.getElementById('mainContainer').style.display = 'flex';

            // å¯ä»¥æ ¹æ®chapterIdåŠ è½½å¯¹åº”ç« èŠ‚çš„æ•°æ®
            console.log('è¿›å…¥ç« èŠ‚ ' + chapterId + ' çš„æ¡ˆæƒ…å›é¡¾');
        }

        // è¿”å›ç« èŠ‚é€‰æ‹©ç•Œé¢
        function backToChapterSelect() {
            // æ˜¾ç¤ºç« èŠ‚é€‰æ‹©ç•Œé¢
            document.getElementById('chapterSelectScreen').style.display = 'flex';
            // éšè—æ¡ˆæƒ…å›é¡¾ä¸»ç•Œé¢
            document.getElementById('mainContainer').style.display = 'none';
            // å…³é—­å¯èƒ½æ‰“å¼€çš„å¼¹çª—
            closeDetail();
            closeDoc();
        }

        // ==================== åŸæœ‰å˜é‡ ====================
        let currentLoop = 1;
        let viewingLoop = 1;

        // å¾ªç¯è¯¦æƒ…æ•°æ®
        const loopDetails = {
            1: {
                title: 'æ®‹é…·çš„èº«ä»½ç¡®è®¤',
                status: 'completed',
                target: 'Morrison',
                events: [
                    { type: 'story', title: 'ç«ç¾ç°åœº', desc: 'Zackèµ¶åˆ°Margareté‹åŠï¼Œå‘ç°çƒ§ç„¦çš„å°¸ä½“ã€‚Morrisonå£°ç§°æ­»è€…æ˜¯Margaretï¼Œä½†ç°åœºç–‘ç‚¹é‡é‡ã€‚' },
                    { type: 'normal', title: 'æœè¯é˜¶æ®µ', desc: 'åœ¨ç«ç¾ç°åœºå’Œé‹åŠäºŒæ¥¼æ”¶é›†è¯æ®ã€‚å‘ç°å©šæˆ’ä½ç½®çŸ›ç›¾â€”â€”æ­»è€…æˆ´åœ¨å³æ‰‹ï¼Œè€ŒMargaretä¹ æƒ¯æˆ´å·¦æ‰‹ã€‚' },
                    { type: 'video', title: 'MorrisonæŒ‡è¯', desc: 'ä½¿ç”¨å©šæˆ’è¯æ®å’ŒFosterå£ä¾›ï¼Œä¸¤è½®æŒ‡è¯å‡»ç ´Morrisonå…³äºæ­»è€…èº«ä»½çš„è°è¨€ã€‚' },
                    { type: 'story', title: 'çœŸç›¸æ­éœ²', desc: 'æ­»è€…æ˜¯Frank Kowalskiï¼ŒMargaretä¸‹è½ä¸æ˜ã€‚Morrisonæ‰¿è®¤è‡ªå·±è¯´è°ï¼Œä½†åšç§°ä¸çŸ¥é“Frankä¸ºä½•ä¼šæ­»åœ¨è¿™é‡Œã€‚' }
                ]
            },
            2: {
                title: 'å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨',
                status: 'completed',
                target: 'Leonard Ross',
                events: [
                    { type: 'story', title: 'è°ƒæŸ¥FrankèƒŒæ™¯', desc: 'å¼€å§‹è°ƒæŸ¥Frankçš„ç”Ÿå‰æƒ…å†µï¼Œå‘ç°ä»–æ¬ Mooreé“¶è¡Œä¸€å¤§ç¬”é’±ï¼Œä¸”æ›¾å—åˆ°å¨èƒã€‚' },
                    { type: 'normal', title: 'è¿å·é’ç¥¨å‘ç°', desc: 'åœ¨O\'Haraå®¶å‘ç°Frankè—èµ·æ¥çš„ç°é‡‘ï¼Œä¸é…’å§Vinnieæ‰‹ä¸­çš„é’ç¥¨æ˜¯è¿å·ã€‚è¿™æ­ç¤ºäº†é“¶è¡Œä¸é»‘å¸®çš„å‹¾ç»“ã€‚' },
                    { type: 'normal', title: 'è¯äººè®¿è°ˆ', desc: 'ä¸å¤šä½è¯äººäº¤è°ˆï¼Œé€æ­¥æ‹¼å‡‘å‡ºLeonardé›‡ä½£Vinnieè¿›è¡Œæš´åŠ›å‚¬å€ºçš„è¯æ®é“¾ã€‚' },
                    { type: 'video', title: 'LeonardæŒ‡è¯', desc: 'ä¸‰è½®æ¿€çƒˆæŒ‡è¯ï¼Œæ­éœ²Leonard Rossé›‡ä½£Vinnie Morettiå¯¹Frankè¿›è¡Œæš´åŠ›å¨èƒå‚¬å€ºçš„çœŸç›¸ã€‚' }
                ]
            },
            3: {
                title: 'æ å¤ºæ€§è´·æ¬¾æ­éœ²',
                status: 'completed',
                target: 'Harold Moore',
                events: [
                    { type: 'story', title: 'Mickeyç™»åœº', desc: 'ç¥ç§˜äººMickeyä¸»åŠ¨æ¥è§¦Zackï¼Œè¡¨ç¤ºæ„¿æ„ååŠ©è·å–é“¶è¡Œå†…éƒ¨æ–‡ä»¶ï¼Œä½†ç›®çš„ä¸æ˜ã€‚' },
                    { type: 'normal', title: 'é“¶è¡Œæ¡£æ¡ˆè°ƒæŸ¥', desc: 'æ½œå…¥é“¶è¡Œè·å–è´·æ¬¾æ¡£æ¡ˆï¼Œå‘ç°æ å¤ºæ€§è´·æ¬¾çš„è¿æ³•æ¡æ¬¾å’ŒMooreæŠ•èµ„å…¬å¸çš„ç§˜å¯†å…³è”ã€‚' },
                    { type: 'normal', title: 'é—å˜±å‘ç°', desc: 'åœ¨è°ƒæŸ¥è¿‡ç¨‹ä¸­å‘ç°Frankçš„é—å˜±å‰¯æœ¬ï¼Œé—äº§åˆ†é…æ¶‰åŠå¤šæ–¹åˆ©ç›Šã€‚' },
                    { type: 'video', title: 'MooreæŒ‡è¯', desc: 'ä¸‰è½®æŒ‡è¯æ­éœ²Mooreé“¶è¡Œçš„ç³»ç»Ÿæ€§è´·æ¬¾æ¬ºè¯ˆï¼ŒHarold Mooreæ‰¿è®¤è®¾è®¡äº†æ å¤ºæ€§è´·æ¬¾æ¡æ¬¾ã€‚' }
                ]
            },
            4: {
                title: 'Roseæ·±æƒ…å‘Šç™½',
                status: 'current',
                target: '???',
                events: [
                    { type: 'story', title: 'é—å˜±äº‰è®®', desc: 'Frankçš„é—äº§å½’å±å¼•å‘æ–°çš„ç–‘ç‚¹ï¼Œå¤šæ–¹åŠ¿åŠ›å¼€å§‹æµ®å‡ºæ°´é¢...' },
                    { type: 'normal', title: 'çº¦ä¼šæˆ¿é—´è°ƒæŸ¥', desc: 'å½“å‰ç›®æ ‡ï¼šè°ƒæŸ¥Margareté‹åŠåœ°ä¸‹å®¤çš„çº¦ä¼šæˆ¿é—´ï¼Œå¯»æ‰¾æ›´å¤šçº¿ç´¢ã€‚', pending: true },
                    { type: 'normal', title: 'æŒ‡è¯é˜¶æ®µ', desc: 'å°šæœªåˆ°è¾¾', pending: true }
                ]
            }
        };

        function selectLoop(loopId) {
            document.querySelectorAll('.case-file').forEach(card => {
                card.classList.remove('active');
            });

            const cards = document.querySelectorAll('.case-file:not(.locked)');
            if (loopId <= cards.length) {
                cards[loopId - 1].classList.add('active');
                currentLoop = loopId;
            }
        }

        function openDetail(loopId) {
            viewingLoop = loopId;
            const data = loopDetails[loopId];
            if (!data) return;

            document.getElementById('detailTitle').textContent = data.title;

            const statusEl = document.getElementById('detailStatus');
            if (data.status === 'completed') {
                statusEl.textContent = 'å·²å®Œæˆ';
                statusEl.className = 'status-tag';
            } else {
                statusEl.textContent = 'è¿›è¡Œä¸­';
                statusEl.className = 'status-tag current';
            }

            // ç”Ÿæˆäº‹ä»¶æ—¶é—´çº¿
            let html = '';
            data.events.forEach(event => {
                const pendingClass = event.pending ? ' pending' : '';
                const typeClass = event.type === 'story' ? ' story' : (event.type === 'video' ? ' video' : '');

                html += `<div class="detail-event${typeClass}${pendingClass}">`;
                html += `<h4>`;
                if (event.type === 'story') {
                    html += `<span class="tag story">å‰§æƒ…</span>`;
                } else if (event.type === 'video') {
                    html += `<span class="tag video">æŒ‡è¯</span>`;
                }
                html += `${event.title}</h4>`;
                html += `<p>${event.desc}</p>`;
                if (event.type === 'video' && !event.pending) {
                    html += `<button class="video-btn" onclick="playVideo('${event.title}')">â–¶ å›çœ‹æŒ‡è¯è§†é¢‘</button>`;
                }
                html += `</div>`;
            });

            document.getElementById('detailTimeline').innerHTML = html;

            // å›æº¯æŒ‰é’®çŠ¶æ€
            const replayBtn = document.getElementById('detailReplayBtn');
            if (data.status === 'current') {
                replayBtn.disabled = true;
                replayBtn.textContent = 'å½“å‰è¿›è¡Œä¸­';
            } else {
                replayBtn.disabled = false;
                replayBtn.textContent = 'âª å›æº¯è‡³æ­¤';
            }

            document.getElementById('detailModal').classList.add('active');
        }

        function closeDetail() {
            document.getElementById('detailModal').classList.remove('active');
        }

        function replayFromDetail() {
            const data = loopDetails[viewingLoop];
            if (data && data.status === 'completed') {
                if (confirm(`ç¡®å®šè¦å›æº¯åˆ°ã€Œ${data.title}ã€çš„èµ·ç‚¹å—ï¼Ÿ\n\nåç»­è¿›åº¦å°†è¢«é‡ç½®ã€‚`)) {
                    alert('æ­£åœ¨åŠ è½½å­˜æ¡£...\n\nï¼ˆæ¼”ç¤ºåŠŸèƒ½ï¼‰');
                    closeDetail();
                }
            }
        }

        function playVideo(title) {
            alert(`æ’­æ”¾ã€Œ${title}ã€è§†é¢‘...\n\nï¼ˆæ¼”ç¤ºåŠŸèƒ½ï¼‰`);
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            window.history.back();
        }

        function openDoc() {
            document.getElementById('docModal').classList.add('active');
        }

        function closeDoc() {
            document.getElementById('docModal').classList.remove('active');
        }

        document.getElementById('docModal').addEventListener('click', function(e) {
            if (e.target === this) closeDoc();
        });

        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) closeDetail();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDoc();
                closeDetail();
            }
        });
    </script>
</body>
</html>
