<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NDC - æ¡ˆæƒ…å›é¡¾ç³»ç»Ÿ (OVERVIEW)</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+SC:wght@400;600;700&family=Special+Elite&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0808;
            color: #e8e4d9;
            font-family: 'Noto Serif SC', serif;
            min-height: 100vh;
            overflow: hidden;
        }

        /* å™ªç‚¹çº¹ç† */
        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* ==================== å·¦ä¾§é¢æ¿ - æ¡ˆä»¶æ¡£æ¡ˆå¡ç‰‡ ==================== */
        .left-panel {
            width: 400px;
            background: linear-gradient(180deg, #1a1412 0%, #0d0a09 100%);
            border-right: 1px solid #3a2a20;
            display: flex;
            flex-direction: column;
        }

        /* ç« èŠ‚æ ‡é¢˜ */
        .chapter-header {
            padding: 25px 20px;
            border-bottom: 1px solid #3a2a20;
            background: rgba(30,20,15,0.8);
        }

        .chapter-header h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            color: #d4af37;
            letter-spacing: 3px;
            margin-bottom: 8px;
        }

        .chapter-header .subtitle {
            font-size: 0.9em;
            color: #8a7a6a;
        }

        /* æ¡ˆä»¶å¡ç‰‡åŒºåŸŸ - çº¢è‰²æ¡£æ¡ˆé£æ ¼ */
        .case-file-area {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* æ¡£æ¡ˆå¡ç‰‡ */
        .case-file {
            background: linear-gradient(135deg, #6B1C1C 0%, #4a1515 50%, #2a0a0a 100%);
            border: 2px solid #8a3030;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .case-file:hover {
            transform: translateX(5px);
            box-shadow: -5px 5px 20px rgba(107,28,28,0.5);
        }

        .case-file.active {
            border-color: #d4af37;
            box-shadow: 0 0 25px rgba(212,175,55,0.3);
        }

        .case-file.locked {
            opacity: 0.4;
            filter: grayscale(0.6);
            cursor: not-allowed;
        }

        .case-file.locked:hover {
            transform: none;
            box-shadow: none;
        }

        /* æ¡ˆä»¶æ ‡é¢˜ */
        .case-file .file-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .case-file .case-title {
            font-family: 'Special Elite', cursive;
            font-size: 0.85em;
            color: #ffd700;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .case-file .case-name {
            font-size: 1.15em;
            color: #fff;
            font-weight: 600;
        }

        /* çŠ¶æ€æ ‡ç­¾ */
        .status-badge {
            font-size: 0.7em;
            padding: 4px 10px;
            border-radius: 3px;
            font-weight: 600;
        }

        .status-badge.completed {
            background: rgba(76,175,80,0.3);
            color: #6fcf70;
            border: 1px solid #4caf50;
        }

        .status-badge.current {
            background: rgba(255,193,7,0.3);
            color: #ffd54f;
            border: 1px solid #ffc107;
        }

        .status-badge.locked {
            background: rgba(100,100,100,0.3);
            color: #888;
            border: 1px solid #555;
        }

        /* æ¡ˆä»¶ä¿¡æ¯ */
        .case-file .case-info {
            font-size: 0.85em;
            color: #ccc;
            line-height: 1.6;
        }

        .case-file .case-info .target {
            color: #ffd700;
            font-weight: 600;
        }

        .case-file .case-info .hidden {
            color: #888;
            font-style: italic;
        }

        /* å°ç«  */
        .stamp-overlay {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%) rotate(-12deg);
            font-family: 'Special Elite', cursive;
            font-size: 1.8em;
            padding: 8px 20px;
            border: 3px solid;
            border-radius: 8px;
            opacity: 0.9;
        }

        .stamp-overlay.solved {
            color: #4caf50;
            border-color: #4caf50;
        }

        .stamp-overlay.progress {
            color: #ffc107;
            border-color: #ffc107;
            font-size: 1.2em;
        }

        /* ==================== ä¸­é—´é¢æ¿ - å‚ç›´æ—¶é—´çº¿ ==================== */
        .center-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: linear-gradient(180deg, #12100d 0%, #0a0908 100%);
        }

        /* é¡¶éƒ¨æ ‡é¢˜ */
        .panel-header {
            padding: 20px 30px;
            border-bottom: 1px solid #3a2a20;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .panel-title h1 {
            font-family: 'Cinzel', serif;
            font-size: 1.6em;
            color: #d4af37;
            letter-spacing: 3px;
        }

        .panel-title .cn {
            font-size: 1em;
            color: #8b7355;
        }

        .close-btn {
            padding: 10px 25px;
            background: linear-gradient(180deg, #4a3a2a, #2a1a10);
            border: 1px solid #8b7355;
            color: #e8e4d9;
            font-family: 'Noto Serif SC', serif;
            cursor: pointer;
            border-radius: 3px;
        }

        .close-btn:hover {
            background: linear-gradient(180deg, #5a4a3a, #3a2a20);
        }

        /* æ—¶é—´çº¿å®¹å™¨ - å‚ç›´æ»šåŠ¨ */
        .timeline-container {
            flex: 1;
            overflow-y: auto;
            padding: 30px 50px;
            position: relative;
        }

        /* å‚ç›´æ—¶é—´çº¿ */
        .vertical-timeline {
            position: relative;
            padding-left: 60px;
        }

        /* æ—¶é—´çº¿ä¸»è½´ */
        .vertical-timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #8b7355, #5a4a3a, #3a2a20);
        }

        /* å¾ªç¯èŠ‚ç‚¹ç»„ */
        .loop-group {
            margin-bottom: 40px;
            position: relative;
        }

        /* å¾ªç¯æ ‡é¢˜ */
        .loop-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }

        .loop-marker {
            position: absolute;
            left: -48px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B2323, #5a1515);
            border: 3px solid #aa4040;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Special Elite', cursive;
            font-size: 0.8em;
            color: #fff;
            z-index: 10;
        }

        .loop-marker.completed {
            background: linear-gradient(135deg, #2e7d32, #1b5e20);
            border-color: #4caf50;
        }

        .loop-marker.current {
            background: linear-gradient(135deg, #f57c00, #e65100);
            border-color: #ffc107;
            animation: pulse 2s infinite;
        }

        .loop-marker.locked {
            background: #333;
            border-color: #555;
            color: #666;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255,193,7,0.5); }
            50% { box-shadow: 0 0 0 10px rgba(255,193,7,0); }
        }

        .loop-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.1em;
            color: #d4af37;
            letter-spacing: 1px;
        }

        /* äº‹ä»¶èŠ‚ç‚¹ */
        .event-node {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding-left: 10px;
            position: relative;
        }

        .event-node::before {
            content: '';
            position: absolute;
            left: -40px;
            top: 8px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #3a2a20;
            border: 2px solid #5a4a3a;
        }

        .event-node.completed::before {
            background: #4caf50;
            border-color: #6fcf70;
        }

        .event-node.story::before {
            border-color: #e85a5a;
        }

        .event-node.completed.story::before {
            background: #e85a5a;
        }

        .event-node.video::before {
            border-color: #9a5ae8;
        }

        .event-node.completed.video::before {
            background: #9a5ae8;
        }

        .event-content {
            background: rgba(30,25,20,0.8);
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 12px 15px;
            flex: 1;
            max-width: 500px;
            transition: all 0.3s ease;
        }

        .event-node.completed .event-content {
            cursor: pointer;
        }

        .event-node.completed .event-content:hover {
            border-color: #8b7355;
            background: rgba(40,35,30,0.9);
        }

        .event-content h4 {
            font-size: 0.95em;
            color: #c9a86c;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .event-content h4 .title-text {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .event-content .expand-arrow {
            color: #8b7355;
            font-size: 0.8em;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .event-content.expanded .expand-arrow {
            transform: rotate(180deg);
        }

        .event-content p {
            font-size: 0.85em;
            color: #8b7a6a;
            line-height: 1.5;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            margin-top: 0;
            transition: all 0.3s ease;
        }

        .event-content.expanded p {
            max-height: 200px;
            opacity: 1;
            margin-top: 10px;
        }

        .event-tag {
            display: inline-block;
            font-size: 0.7em;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 8px;
        }

        .event-tag.story {
            background: rgba(232,90,90,0.2);
            color: #e85a5a;
            border: 1px solid #e85a5a;
        }

        .event-tag.video {
            background: rgba(154,90,232,0.2);
            color: #9a5ae8;
            border: 1px solid #9a5ae8;
        }

        /* é”å®šå†…å®¹ */
        .locked-content {
            color: #555;
            font-style: italic;
            padding: 15px;
        }

        /* ==================== å³ä¾§é¢æ¿ - è¯¦æƒ…ä¸æ“ä½œ ==================== */
        .right-panel {
            width: 320px;
            background: linear-gradient(180deg, #1a1412 0%, #0d0a09 100%);
            border-left: 1px solid #3a2a20;
            display: flex;
            flex-direction: column;
        }

        .detail-section {
            padding: 20px;
            border-bottom: 1px solid #2a1a10;
        }

        .detail-section h3 {
            font-size: 0.9em;
            color: #8b7355;
            margin-bottom: 15px;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* å½“å‰é€‰ä¸­ä¿¡æ¯ */
        .selected-info {
            background: rgba(30,25,20,0.8);
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 15px;
        }

        .selected-info .loop-name {
            font-size: 1.1em;
            color: #d4af37;
            margin-bottom: 10px;
        }

        .selected-info .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #2a1a10;
            font-size: 0.85em;
        }

        .selected-info .info-row:last-child {
            border-bottom: none;
        }

        .selected-info .label {
            color: #8b7355;
        }

        .selected-info .value {
            color: #e8e4d9;
        }

        /* è¯´æ˜æ–‡å­— */
        .hint-text {
            padding: 15px;
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 5px;
            font-size: 0.85em;
            color: #c9a86c;
            line-height: 1.6;
        }

        /* æ“ä½œæŒ‰é’® */
        .action-area {
            padding: 20px;
            margin-top: auto;
        }

        .action-btn {
            width: 100%;
            padding: 15px;
            font-family: 'Noto Serif SC', serif;
            font-size: 1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .action-btn.primary {
            background: linear-gradient(180deg, #8B2323, #5a1515);
            color: #fff;
            border: 2px solid #aa4040;
        }

        .action-btn.primary:hover {
            background: linear-gradient(180deg, #9B3333, #6a2525);
            box-shadow: 0 0 20px rgba(139,35,35,0.5);
        }

        .action-btn.primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-btn.secondary {
            background: linear-gradient(180deg, #3a3025, #252015);
            color: #d4af37;
            border: 2px solid #8b7355;
        }

        .action-btn.secondary:hover {
            background: linear-gradient(180deg, #4a4035, #352a20);
        }

        .action-btn.doc {
            background: linear-gradient(180deg, #1a3a5a, #0a2a4a);
            color: #5aafe8;
            border: 2px solid #3a7aba;
        }

        .action-btn.doc:hover {
            background: linear-gradient(180deg, #2a4a6a, #1a3a5a);
            box-shadow: 0 0 15px rgba(90,175,232,0.4);
        }

        /* ==================== è¯¦æƒ…å¼¹çª— ==================== */
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1500;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .detail-modal.active {
            display: flex;
        }

        .detail-modal-content {
            width: 90%;
            max-width: 800px;
            max-height: 85vh;
            background: linear-gradient(180deg, #1a1815 0%, #0f0c0a 100%);
            border: 2px solid #8b7355;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .detail-modal-header {
            background: linear-gradient(90deg, #6B1C1C, #4a1515);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail-modal-header h2 {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.4em;
            color: #fff;
        }

        .detail-modal-header .status-tag {
            background: rgba(76,175,80,0.3);
            color: #6fcf70;
            border: 1px solid #4caf50;
            padding: 5px 15px;
            border-radius: 3px;
            font-size: 0.85em;
        }

        .detail-modal-header .status-tag.current {
            background: rgba(255,193,7,0.3);
            color: #ffd54f;
            border-color: #ffc107;
        }

        .detail-modal-close {
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 50%;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }

        .detail-modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 25px 30px;
        }

        /* è¯¦æƒ…æ—¶é—´çº¿ */
        .detail-timeline {
            position: relative;
            padding-left: 40px;
        }

        .detail-timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #8b7355, #5a4a3a);
        }

        .detail-event {
            position: relative;
            margin-bottom: 25px;
            padding: 15px 20px;
            background: rgba(30,25,20,0.8);
            border: 1px solid #3a2a20;
            border-radius: 5px;
        }

        .detail-event::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4caf50;
            border: 2px solid #6fcf70;
        }

        .detail-event.story::before {
            background: #e85a5a;
            border-color: #ff7a7a;
        }

        .detail-event.video::before {
            background: #9a5ae8;
            border-color: #ba7aff;
        }

        .detail-event.pending::before {
            background: #3a2a20;
            border-color: #5a4a3a;
        }

        .detail-event h4 {
            color: #c9a86c;
            font-size: 1.05em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-event h4 .tag {
            font-size: 0.7em;
            padding: 3px 10px;
            border-radius: 3px;
        }

        .detail-event h4 .tag.story {
            background: rgba(232,90,90,0.2);
            color: #e85a5a;
            border: 1px solid #e85a5a;
        }

        .detail-event h4 .tag.video {
            background: rgba(154,90,232,0.2);
            color: #9a5ae8;
            border: 1px solid #9a5ae8;
        }

        .detail-event p {
            color: #8b7a6a;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .detail-event .video-btn {
            margin-top: 12px;
            padding: 8px 20px;
            background: linear-gradient(180deg, #5a3a8a, #3a2a5a);
            border: 1px solid #9a5ae8;
            color: #ba7aff;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .detail-event .video-btn:hover {
            background: linear-gradient(180deg, #6a4a9a, #4a3a6a);
        }

        .detail-modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #3a2a20;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .detail-modal-footer .btn {
            padding: 12px 30px;
            border-radius: 5px;
            font-family: 'Noto Serif SC', serif;
            cursor: pointer;
            font-size: 0.95em;
        }

        .detail-modal-footer .btn-replay {
            background: linear-gradient(180deg, #8B2323, #5a1515);
            color: #fff;
            border: 2px solid #aa4040;
        }

        .detail-modal-footer .btn-replay:hover {
            background: linear-gradient(180deg, #9B3333, #6a2525);
        }

        .detail-modal-footer .btn-replay:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .detail-modal-footer .btn-close {
            background: linear-gradient(180deg, #3a3025, #252015);
            color: #c9a86c;
            border: 1px solid #5a4a3a;
        }

        /* ==================== ç­–åˆ’æ¡ˆå¼¹çª— ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            background: linear-gradient(180deg, #1a1815 0%, #0f0c0a 100%);
            border: 2px solid #8b7355;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            background: linear-gradient(90deg, #8b7355, #5a4a3a);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.4em;
            color: #1a1510;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 50%;
            color: #1a1510;
            font-size: 1.5em;
            cursor: pointer;
        }

        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        /* ç­–åˆ’æ¡ˆæ ·å¼ */
        .doc-section {
            margin-bottom: 35px;
        }

        .doc-section h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.2em;
            color: #d4af37;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #5a4a3a;
        }

        .doc-section h4 {
            font-size: 1em;
            color: #c9a86c;
            margin: 15px 0 10px;
        }

        .doc-section p, .doc-section li {
            color: #a09080;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .doc-section ul {
            margin-left: 20px;
        }

        .doc-section strong {
            color: #e8e4d9;
        }

        .doc-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .doc-table th {
            background: rgba(139,115,85,0.3);
            color: #d4af37;
            padding: 12px;
            text-align: left;
            border: 1px solid #5a4a3a;
            font-size: 0.9em;
        }

        .doc-table td {
            padding: 12px;
            border: 1px solid #3a2a20;
            color: #a09080;
            font-size: 0.85em;
        }

        .highlight-box {
            background: rgba(212,175,55,0.1);
            border: 1px solid #d4af37;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .highlight-box h5 {
            color: #d4af37;
            margin-bottom: 8px;
        }

        .highlight-box p {
            color: #c9a86c;
            margin: 0;
        }

        .flow-diagram {
            background: rgba(30,25,20,0.8);
            border: 1px solid #5a4a3a;
            border-radius: 5px;
            padding: 25px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .flow-step {
            background: linear-gradient(180deg, #3a3025, #252015);
            border: 2px solid #5a4a3a;
            border-radius: 5px;
            padding: 12px 20px;
            text-align: center;
        }

        .flow-step.highlight {
            border-color: #d4af37;
        }

        .flow-step .num {
            font-size: 0.7em;
            color: #8b7355;
        }

        .flow-step .text {
            color: #e8e4d9;
            font-size: 0.9em;
        }

        .flow-arrow {
            color: #5a4a3a;
            font-size: 1.2em;
        }

        .code-block {
            background: #0a0908;
            border: 1px solid #3a2a20;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.8em;
            color: #a09080;
            overflow-x: auto;
            margin: 10px 0;
        }

        .code-block .key { color: #5a9ae8; }
        .code-block .value { color: #e85a5a; }
        .code-block .string { color: #9ae85a; }
        .code-block .comment { color: #666; }
    </style>
</head>
<body>
    <div class="noise-overlay"></div>

    <div class="main-container">
        <!-- å·¦ä¾§ - æ¡ˆä»¶æ¡£æ¡ˆå¡ç‰‡ -->
        <div class="left-panel">
            <div class="chapter-header">
                <h2>UNIT 2</h2>
                <div class="subtitle">Frank Kowalski ä¹‹æ­»</div>
            </div>

            <div class="case-file-area">
                <div class="case-file active" onclick="selectLoop(1)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">æ®‹é…·çš„èº«ä»½ç¡®è®¤</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Morrison</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(2)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Leonard Ross</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(3)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">æ å¤ºæ€§è´·æ¬¾æ­éœ²</div>
                        </div>
                        <span class="status-badge completed">å·²å®Œæˆ</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="target">Harold Moore</span>
                    </div>
                    <div class="stamp-overlay solved">SOLVED</div>
                </div>

                <div class="case-file" onclick="selectLoop(4)">
                    <div class="file-header">
                        <div>
                            <div class="case-name">Roseæ·±æƒ…å‘Šç™½</div>
                        </div>
                        <span class="status-badge current">è¿›è¡Œä¸­</span>
                    </div>
                    <div class="case-info">
                        æŒ‡è¯å¯¹è±¡ï¼š<span class="hidden">???</span>
                    </div>
                    <div class="stamp-overlay progress">IN PROGRESS</div>
                </div>
            </div>
        </div>

        <!-- ä¸­é—´ - å‚ç›´æ—¶é—´çº¿ -->
        <div class="center-panel">
            <div class="panel-header">
                <div class="panel-title">
                    <h1>PROGRESS</h1>
                    <span class="cn">æ¡ˆæƒ…è¿›å±•</span>
                </div>
                <button class="close-btn" onclick="goToSettings()">è¿”å›è®¾ç½®</button>
            </div>

            <div class="timeline-container">
                <div class="vertical-timeline">
                    <!-- æ®‹é…·çš„èº«ä»½ç¡®è®¤ -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">æ®‹é…·çš„èº«ä»½ç¡®è®¤</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(1)">
                                <h4>
                                    <span class="title-text">ç¡®è®¤æ­»è€…èº«ä»½ï¼Œæ­éœ²Morrisonçš„è°è¨€</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨ -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(2)">
                                <h4>
                                    <span class="title-text">è¿½æŸ¥è¿å·é’ç¥¨ï¼Œæ­éœ²æš´åŠ›å‚¬å€º</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- æ å¤ºæ€§è´·æ¬¾æ­éœ² -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker completed">âœ“</div>
                            <div class="loop-title">æ å¤ºæ€§è´·æ¬¾æ­éœ²</div>
                        </div>

                        <div class="event-node completed">
                            <div class="event-content" onclick="openDetail(3)">
                                <h4>
                                    <span class="title-text">æ­éœ²é“¶è¡Œè´·æ¬¾æ¬ºè¯ˆï¼Œè·å¾—é—å˜±å‰¯æœ¬</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>

                    <!-- Roseæ·±æƒ…å‘Šç™½ (å½“å‰) -->
                    <div class="loop-group">
                        <div class="loop-header">
                            <div class="loop-marker current">â—</div>
                            <div class="loop-title">Roseæ·±æƒ…å‘Šç™½</div>
                        </div>

                        <div class="event-node">
                            <div class="event-content" onclick="openDetail(4)">
                                <h4>
                                    <span class="title-text">è°ƒæŸ¥é—å˜±äº‰è®®ä¸çº¦ä¼šæˆ¿é—´</span>
                                    <span class="expand-arrow">â–¶</span>
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å³ä¾§ - æ“ä½œ -->
        <div class="right-panel">
            <div class="action-area">
                <button class="action-btn doc" onclick="openDoc()">
                    ğŸ“‹ ç­–åˆ’æ¡ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <div class="detail-modal" id="detailModal">
        <div class="detail-modal-content">
            <div class="detail-modal-header">
                <h2 id="detailTitle">æ®‹é…·çš„èº«ä»½ç¡®è®¤</h2>
                <span class="status-tag" id="detailStatus">å·²å®Œæˆ</span>
            </div>
            <div class="detail-modal-body">
                <div class="detail-timeline" id="detailTimeline">
                    <!-- åŠ¨æ€å¡«å…… -->
                </div>
            </div>
            <div class="detail-modal-footer">
                <button class="btn btn-close" onclick="closeDetail()">è¿”å›</button>
                <button class="btn btn-replay" id="detailReplayBtn" onclick="replayFromDetail()">âª å›æº¯è‡³æ­¤</button>
            </div>
        </div>
    </div>

    <!-- ç­–åˆ’æ¡ˆå¼¹çª— -->
    <div class="modal-overlay" id="docModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“‹ æ¡ˆæƒ…å›é¡¾ç³»ç»Ÿ - ç­–åˆ’æ¡ˆ</h2>
                <button class="modal-close" onclick="closeDoc()">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- ç³»ç»Ÿæ¦‚è¿° -->
                <div class="doc-section">
                    <h3>ä¸€ã€ç³»ç»Ÿæ¦‚è¿°</h3>
                    <p><strong>ç³»ç»Ÿåç§°</strong>ï¼šæ¡ˆæƒ…å›é¡¾ç³»ç»Ÿï¼ˆOVERVIEWï¼‰</p>
                    <p><strong>ç³»ç»Ÿå®šä½</strong>ï¼šNDCæ ¸å¿ƒé¢æ¿ä¹‹ä¸€ï¼Œæä¾›ç©å®¶å›é¡¾æ¡ˆä»¶è¿›å±•ã€é‡æ–°æ’­æ”¾å‰§æƒ…è§†é¢‘ã€å›æº¯åˆ°æŒ‡å®šèŠ‚ç‚¹é‡æ–°å¼€å§‹çš„åŠŸèƒ½ã€‚</p>

                    <div class="highlight-box">
                        <h5>ğŸ’¡ æ ¸å¿ƒè®¾è®¡ç†å¿µ</h5>
                        <p>ã€Œå¾ªç¯å³å­˜æ¡£ç‚¹ã€- æ¯ä¸ªå¾ªç¯çš„ç»“æŸè‡ªåŠ¨ä¿å­˜è¿›åº¦ã€‚ç©å®¶å¯ä»¥éšæ—¶å›æº¯åˆ°ä»»æ„å·²å®Œæˆå¾ªç¯çš„èµ·ç‚¹é‡æ–°å¼€å§‹æ¸¸æˆï¼Œæ¢ç´¢ä¸åŒé€‰æ‹©å¸¦æ¥çš„ä¸åŒç»“æœã€‚</p>
                    </div>

                    <h4>1.1 ç³»ç»ŸåŠŸèƒ½</h4>
                    <ul>
                        <li><strong>æ¡ˆæƒ…å›é¡¾</strong>ï¼šæŸ¥çœ‹å½“å‰ç« èŠ‚çš„æ•…äº‹èƒŒæ™¯å’Œè¿›åº¦</li>
                        <li><strong>èŠ‚ç‚¹å›æº¯</strong>ï¼šå›åˆ°æŸä¸ªå¾ªç¯èµ·ç‚¹ï¼Œä»è¯¥èŠ‚ç‚¹é‡æ–°å¼€å§‹æ¸¸æˆ</li>
                        <li><strong>è¿›åº¦å±•ç¤º</strong>ï¼šç›´è§‚å±•ç¤ºç©å®¶åœ¨æ¯ä¸ªå¾ªç¯çš„è¿›å±•çŠ¶æ€</li>
                    </ul>
                </div>

                <!-- å­˜æ¡£è§„åˆ™ -->
                <div class="doc-section">
                    <h3>äºŒã€å­˜æ¡£è§„åˆ™</h3>

                    <h4>2.1 å­˜æ¡£è§¦å‘æ—¶æœº</h4>
                    <table class="doc-table">
                        <tr>
                            <th>è§¦å‘æ¡ä»¶</th>
                            <th>å­˜æ¡£ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td>å¾ªç¯ç»“æŸï¼ˆæŒ‡è¯æˆåŠŸï¼‰</td>
                            <td>å¾ªç¯å­˜æ¡£</td>
                            <td><strong>è‡ªåŠ¨è§¦å‘ï¼Œä¸å¯è·³è¿‡</strong></td>
                        </tr>
                        <tr>
                            <td>ç« èŠ‚ç»“æŸ</td>
                            <td>ç« èŠ‚å­˜æ¡£</td>
                            <td>ç‰¹æ®Šæ ‡è®°ï¼ŒåŒ…å«å®Œæ•´ç« èŠ‚æ•°æ®</td>
                        </tr>
                    </table>

                    <div class="highlight-box">
                        <h5>âš ï¸ é‡è¦é™åˆ¶</h5>
                        <p><strong>ä¸æ”¯æŒä¸­é€”å­˜æ¡£</strong>ï¼šç©å®¶æ— æ³•åœ¨å¾ªç¯è¿›è¡Œä¸­æ‰‹åŠ¨ä¿å­˜ï¼Œåªèƒ½åœ¨å¾ªç¯ç»“æŸæ—¶è‡ªåŠ¨ä¿å­˜ã€‚</p>
                    </div>

                    <h4>2.2 å­˜æ¡£æ•°æ®å†…å®¹</h4>
                    <table class="doc-table">
                        <tr>
                            <th>æ•°æ®ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                        <tr>
                            <td>å·²è·å¾—è¯æ®ï¼ˆEvidenceï¼‰</td>
                            <td>ITEMSã€CLUESã€NOTESã€COMBINED</td>
                        </tr>
                        <tr>
                            <td>å·²è§£é”åœºæ™¯</td>
                            <td>å¯å‰å¾€çš„åœ°ç‚¹åˆ—è¡¨</td>
                        </tr>
                        <tr>
                            <td>å·²å®Œæˆå¯¹è¯</td>
                            <td>NPCå¯¹è¯è®°å½•å’Œæå–çš„å…³é”®ä¿¡æ¯</td>
                        </tr>
                        <tr>
                            <td>å‰§æƒ…æ ‡è®°ï¼ˆFlagsï¼‰</td>
                            <td>å·²è§¦å‘çš„äº‹ä»¶å’Œè§£é”æ¡ä»¶</td>
                        </tr>
                        <tr>
                            <td>å¾ªç¯å®ŒæˆçŠ¶æ€</td>
                            <td>è¯¥å¾ªç¯æ˜¯å¦å·²å®Œæˆ</td>
                        </tr>
                    </table>

                    <h4>2.3 å­˜æ¡£æ•°æ®ç»“æ„ç¤ºä¾‹</h4>
                    <div class="code-block">
{
  <span class="key">"loop_id"</span>: <span class="value">1</span>,
  <span class="key">"loop_name"</span>: <span class="string">"æ®‹é…·çš„èº«ä»½ç¡®è®¤"</span>,
  <span class="key">"status"</span>: <span class="string">"completed"</span>,
  <span class="key">"player_data"</span>: {
    <span class="key">"evidence_ids"</span>: [<span class="string">"EV101"</span>, <span class="string">"EV102"</span>, <span class="string">"EV103"</span>],
    <span class="key">"unlocked_scenes"</span>: [<span class="string">"SC201"</span>, <span class="string">"SC202"</span>],
    <span class="key">"completed_dialogues"</span>: [<span class="string">"D201"</span>, <span class="string">"D202"</span>],
    <span class="key">"flags"</span>: {
      <span class="string">"morrison_exposed"</span>: <span class="value">true</span>,
      <span class="string">"frank_identity_confirmed"</span>: <span class="value">true</span>
    }
  }
}
                    </div>
                </div>

                <!-- é‡ç©æœºåˆ¶ -->
                <div class="doc-section">
                    <h3>ä¸‰ã€é‡ç©ï¼ˆå›æº¯ï¼‰æœºåˆ¶</h3>

                    <h4>3.1 å›æº¯æµç¨‹</h4>
                    <div class="flow-diagram">
                        <div class="flow-step">
                            <div class="num">STEP 1</div>
                            <div class="text">æ‰“å¼€OVERVIEW</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 2</div>
                            <div class="text">é€‰æ‹©ç›®æ ‡å¾ªç¯</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step highlight">
                            <div class="num">STEP 3</div>
                            <div class="text">ç‚¹å‡»ã€Œé‡ç©ã€</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 4</div>
                            <div class="text">ç¡®è®¤æç¤º</div>
                        </div>
                        <div class="flow-arrow">â†’</div>
                        <div class="flow-step">
                            <div class="num">STEP 5</div>
                            <div class="text">åŠ è½½å¾ªç¯èµ·ç‚¹</div>
                        </div>
                    </div>

                    <h4>3.2 å›æº¯è§„åˆ™</h4>
                    <table class="doc-table">
                        <tr>
                            <th>æ•°æ®ç±»å‹</th>
                            <th>å›æº¯æ—¶å¤„ç†</th>
                        </tr>
                        <tr>
                            <td>è¯æ®</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å·²è§£é”åœºæ™¯</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å¯¹è¯è®°å½•</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>å‰§æƒ…æ ‡è®°</td>
                            <td><strong>é‡ç½®</strong>ä¸ºè¯¥å¾ªç¯å¼€å§‹æ—¶çš„çŠ¶æ€</td>
                        </tr>
                    </table>

                    <div class="highlight-box">
                        <h5>ğŸ’¡ å›æº¯æ„ä¹‰</h5>
                        <p>AVGå¯¹è¯å†…å®¹å¯èƒ½å› ä¸åŒé€‰æ‹©è€Œä¸åŒï¼Œè·å¾—çš„çº¿ç´¢ä¹Ÿå¯èƒ½ä¸åŒã€‚å›æº¯æœºåˆ¶è®©ç©å®¶å¯ä»¥æ¢ç´¢ä¸åŒçš„é€‰æ‹©è·¯å¾„ã€‚</p>
                    </div>
                </div>

                <!-- UIè®¾è®¡ -->
                <div class="doc-section">
                    <h3>å››ã€UIç•Œé¢è®¾è®¡</h3>

                    <h4>4.1 ç•Œé¢å¸ƒå±€</h4>
                    <table class="doc-table">
                        <tr>
                            <th>åŒºåŸŸ</th>
                            <th>å†…å®¹</th>
                            <th>åŠŸèƒ½</th>
                        </tr>
                        <tr>
                            <td>å·¦ä¾§é¢æ¿</td>
                            <td>å¾ªç¯æ¡£æ¡ˆå¡ç‰‡</td>
                            <td>å±•ç¤ºæ‰€æœ‰å¾ªç¯çŠ¶æ€ï¼Œç‚¹å‡»åˆ‡æ¢é€‰ä¸­</td>
                        </tr>
                        <tr>
                            <td>ä¸­é—´é¢æ¿</td>
                            <td>å‚ç›´æ—¶é—´çº¿</td>
                            <td>ä¸Šä¸‹æ»šåŠ¨æŸ¥çœ‹å„å¾ªç¯çš„äº‹ä»¶èŠ‚ç‚¹</td>
                        </tr>
                        <tr>
                            <td>å³ä¾§é¢æ¿</td>
                            <td>è¯¦æƒ…ä¸æ“ä½œ</td>
                            <td>æ˜¾ç¤ºé€‰ä¸­å¾ªç¯ä¿¡æ¯ï¼Œæä¾›é‡ç©æŒ‰é’®</td>
                        </tr>
                    </table>

                    <h4>4.2 å¾ªç¯å¡ç‰‡çŠ¶æ€</h4>
                    <ul>
                        <li><strong style="color:#4caf50">å·²å®Œæˆï¼ˆSOLVEDï¼‰</strong>ï¼šæ˜¾ç¤ºæŒ‡è¯å¯¹è±¡ï¼Œå¯é‡ç©</li>
                        <li><strong style="color:#ffc107">è¿›è¡Œä¸­ï¼ˆIN PROGRESSï¼‰</strong>ï¼šæŒ‡è¯å¯¹è±¡æ˜¾ç¤ºä¸ºã€Œ???ã€ï¼Œä¸å¯é‡ç©</li>
                        <li><strong style="color:#666">æœªè§£é”ï¼ˆLOCKEDï¼‰</strong>ï¼šåç§°å’Œä¿¡æ¯å…¨éƒ¨éšè—ï¼Œä¸å¯ç‚¹å‡»</li>
                    </ul>

                    <h4>4.3 æ—¶é—´çº¿èŠ‚ç‚¹ç±»å‹</h4>
                    <ul>
                        <li><strong style="color:#e85a5a">å‰§æƒ…èŠ‚ç‚¹ï¼ˆçº¢è‰²ï¼‰</strong>ï¼šå…³é”®å‰§æƒ…ç‚¹ï¼Œè‡ªåŠ¨æ’­æ”¾çš„æ•…äº‹å†…å®¹</li>
                        <li><strong>æ™®é€šèŠ‚ç‚¹</strong>ï¼šæœè¯é˜¶æ®µç­‰å¯äº¤äº’å†…å®¹</li>
                        <li><strong style="color:#9a5ae8">æŒ‡è¯èŠ‚ç‚¹ï¼ˆç´«è‰²ï¼‰</strong>ï¼šæŒ‡è¯æ¼”å‡º</li>
                    </ul>
                </div>

                <!-- Unit 2 é…ç½® -->
                <div class="doc-section">
                    <h3>äº”ã€Unit 2 å¾ªç¯é…ç½®</h3>

                    <table class="doc-table">
                        <tr>
                            <th>å¾ªç¯</th>
                            <th>åç§°</th>
                            <th>æŒ‡è¯å¯¹è±¡</th>
                            <th>æŒ‡è¯è½®æ¬¡</th>
                        </tr>
                        <tr>
                            <td>Loop 1</td>
                            <td>æ®‹é…·çš„èº«ä»½ç¡®è®¤</td>
                            <td>Morrison</td>
                            <td>2è½®</td>
                        </tr>
                        <tr>
                            <td>Loop 2</td>
                            <td>å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨</td>
                            <td>Leonard Ross</td>
                            <td>3è½®</td>
                        </tr>
                        <tr>
                            <td>Loop 3</td>
                            <td>æ å¤ºæ€§è´·æ¬¾æ­éœ²</td>
                            <td>Harold Moore</td>
                            <td>3è½®</td>
                        </tr>
                        <tr>
                            <td>Loop 4</td>
                            <td>Roseæ·±æƒ…å‘Šç™½</td>
                            <td>Danny Kowalski</td>
                            <td>3è½®</td>
                        </tr>
                        <tr>
                            <td>Loop 5</td>
                            <td>Vinnieçºµç«è®¤ç½ª</td>
                            <td>Vinnie Moretti</td>
                            <td>1è½®</td>
                        </tr>
                        <tr>
                            <td>Loop 6</td>
                            <td>Leonardç»ˆææŒ‡è¯</td>
                            <td>Leonard Russo</td>
                            <td>4è½®</td>
                        </tr>
                    </table>
                </div>

                <!-- ä¸å…¶ä»–ç³»ç»Ÿçš„å…³ç³» -->
                <div class="doc-section">
                    <h3>å…­ã€ä¸å…¶ä»–ç³»ç»Ÿçš„å…³ç³»</h3>

                    <h4>6.1 å…¥å£ä½ç½®</h4>
                    <p>åœ¨EXPLORINGåœºæ™¯æ¢ç´¢é¢æ¿çš„å·¦ä¸Šè§’å¯¼èˆªæ ä¸­ï¼Œç‚¹å‡»OVERVIEWå¯è¿›å…¥æœ¬ç³»ç»Ÿã€‚</p>

                    <h4>6.2 æ•°æ®æ¥æº</h4>
                    <ul>
                        <li><strong>Evidenceæ•°æ®</strong>ï¼šæ¥è‡ªCASE BOARDé¢æ¿ä¸­çš„ITEMSã€CLUESã€NOTESã€COMBINED</li>
                        <li><strong>Sceneæ•°æ®</strong>ï¼šæ¥è‡ªMAPåœ°å›¾é¢æ¿ä¸­å·²è§£é”çš„åœºæ™¯</li>
                        <li><strong>Dialogueæ•°æ®</strong>ï¼šæ¥è‡ªNPCå¯¹è¯çš„AVGè®°å½•</li>
                    </ul>

                    <h4>6.3 è§¦å‘æ—¶æœº</h4>
                    <p>å¾ªç¯ç»“æŸåï¼ˆæŒ‡è¯æˆåŠŸï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨ä¿å­˜å½“å‰çŠ¶æ€åˆ°å¯¹åº”å¾ªç¯çš„å­˜æ¡£ä¸­ã€‚</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLoop = 1;
        let viewingLoop = 1;

        // å¾ªç¯è¯¦æƒ…æ•°æ®
        const loopDetails = {
            1: {
                title: 'æ®‹é…·çš„èº«ä»½ç¡®è®¤',
                status: 'completed',
                target: 'Morrison',
                events: [
                    { type: 'story', title: 'ç«ç¾ç°åœº', desc: 'Zackèµ¶åˆ°Margareté‹åŠï¼Œå‘ç°çƒ§ç„¦çš„å°¸ä½“ã€‚Morrisonå£°ç§°æ­»è€…æ˜¯Margaretï¼Œä½†ç°åœºç–‘ç‚¹é‡é‡ã€‚' },
                    { type: 'normal', title: 'æœè¯é˜¶æ®µ', desc: 'åœ¨ç«ç¾ç°åœºå’Œé‹åŠäºŒæ¥¼æ”¶é›†è¯æ®ã€‚å‘ç°å©šæˆ’ä½ç½®çŸ›ç›¾â€”â€”æ­»è€…æˆ´åœ¨å³æ‰‹ï¼Œè€ŒMargaretä¹ æƒ¯æˆ´å·¦æ‰‹ã€‚' },
                    { type: 'video', title: 'MorrisonæŒ‡è¯', desc: 'ä½¿ç”¨å©šæˆ’è¯æ®å’ŒFosterå£ä¾›ï¼Œä¸¤è½®æŒ‡è¯å‡»ç ´Morrisonå…³äºæ­»è€…èº«ä»½çš„è°è¨€ã€‚' },
                    { type: 'story', title: 'çœŸç›¸æ­éœ²', desc: 'æ­»è€…æ˜¯Frank Kowalskiï¼ŒMargaretä¸‹è½ä¸æ˜ã€‚Morrisonæ‰¿è®¤è‡ªå·±è¯´è°ï¼Œä½†åšç§°ä¸çŸ¥é“Frankä¸ºä½•ä¼šæ­»åœ¨è¿™é‡Œã€‚' }
                ]
            },
            2: {
                title: 'å¨èƒé“¾æ¡ä¸è¿å·é’ç¥¨',
                status: 'completed',
                target: 'Leonard Ross',
                events: [
                    { type: 'story', title: 'è°ƒæŸ¥FrankèƒŒæ™¯', desc: 'å¼€å§‹è°ƒæŸ¥Frankçš„ç”Ÿå‰æƒ…å†µï¼Œå‘ç°ä»–æ¬ Mooreé“¶è¡Œä¸€å¤§ç¬”é’±ï¼Œä¸”æ›¾å—åˆ°å¨èƒã€‚' },
                    { type: 'normal', title: 'è¿å·é’ç¥¨å‘ç°', desc: 'åœ¨O\'Haraå®¶å‘ç°Frankè—èµ·æ¥çš„ç°é‡‘ï¼Œä¸é…’å§Vinnieæ‰‹ä¸­çš„é’ç¥¨æ˜¯è¿å·ã€‚è¿™æ­ç¤ºäº†é“¶è¡Œä¸é»‘å¸®çš„å‹¾ç»“ã€‚' },
                    { type: 'normal', title: 'è¯äººè®¿è°ˆ', desc: 'ä¸å¤šä½è¯äººäº¤è°ˆï¼Œé€æ­¥æ‹¼å‡‘å‡ºLeonardé›‡ä½£Vinnieè¿›è¡Œæš´åŠ›å‚¬å€ºçš„è¯æ®é“¾ã€‚' },
                    { type: 'video', title: 'LeonardæŒ‡è¯', desc: 'ä¸‰è½®æ¿€çƒˆæŒ‡è¯ï¼Œæ­éœ²Leonard Rossé›‡ä½£Vinnie Morettiå¯¹Frankè¿›è¡Œæš´åŠ›å¨èƒå‚¬å€ºçš„çœŸç›¸ã€‚' }
                ]
            },
            3: {
                title: 'æ å¤ºæ€§è´·æ¬¾æ­éœ²',
                status: 'completed',
                target: 'Harold Moore',
                events: [
                    { type: 'story', title: 'Mickeyç™»åœº', desc: 'ç¥ç§˜äººMickeyä¸»åŠ¨æ¥è§¦Zackï¼Œè¡¨ç¤ºæ„¿æ„ååŠ©è·å–é“¶è¡Œå†…éƒ¨æ–‡ä»¶ï¼Œä½†ç›®çš„ä¸æ˜ã€‚' },
                    { type: 'normal', title: 'é“¶è¡Œæ¡£æ¡ˆè°ƒæŸ¥', desc: 'æ½œå…¥é“¶è¡Œè·å–è´·æ¬¾æ¡£æ¡ˆï¼Œå‘ç°æ å¤ºæ€§è´·æ¬¾çš„è¿æ³•æ¡æ¬¾å’ŒMooreæŠ•èµ„å…¬å¸çš„ç§˜å¯†å…³è”ã€‚' },
                    { type: 'normal', title: 'é—å˜±å‘ç°', desc: 'åœ¨è°ƒæŸ¥è¿‡ç¨‹ä¸­å‘ç°Frankçš„é—å˜±å‰¯æœ¬ï¼Œé—äº§åˆ†é…æ¶‰åŠå¤šæ–¹åˆ©ç›Šã€‚' },
                    { type: 'video', title: 'MooreæŒ‡è¯', desc: 'ä¸‰è½®æŒ‡è¯æ­éœ²Mooreé“¶è¡Œçš„ç³»ç»Ÿæ€§è´·æ¬¾æ¬ºè¯ˆï¼ŒHarold Mooreæ‰¿è®¤è®¾è®¡äº†æ å¤ºæ€§è´·æ¬¾æ¡æ¬¾ã€‚' }
                ]
            },
            4: {
                title: 'Roseæ·±æƒ…å‘Šç™½',
                status: 'current',
                target: '???',
                events: [
                    { type: 'story', title: 'é—å˜±äº‰è®®', desc: 'Frankçš„é—äº§å½’å±å¼•å‘æ–°çš„ç–‘ç‚¹ï¼Œå¤šæ–¹åŠ¿åŠ›å¼€å§‹æµ®å‡ºæ°´é¢...' },
                    { type: 'normal', title: 'çº¦ä¼šæˆ¿é—´è°ƒæŸ¥', desc: 'å½“å‰ç›®æ ‡ï¼šè°ƒæŸ¥Margareté‹åŠåœ°ä¸‹å®¤çš„çº¦ä¼šæˆ¿é—´ï¼Œå¯»æ‰¾æ›´å¤šçº¿ç´¢ã€‚', pending: true },
                    { type: 'normal', title: 'æŒ‡è¯é˜¶æ®µ', desc: 'å°šæœªåˆ°è¾¾', pending: true }
                ]
            }
        };

        function selectLoop(loopId) {
            document.querySelectorAll('.case-file').forEach(card => {
                card.classList.remove('active');
            });

            const cards = document.querySelectorAll('.case-file:not(.locked)');
            if (loopId <= cards.length) {
                cards[loopId - 1].classList.add('active');
                currentLoop = loopId;
            }
        }

        function openDetail(loopId) {
            viewingLoop = loopId;
            const data = loopDetails[loopId];
            if (!data) return;

            document.getElementById('detailTitle').textContent = data.title;

            const statusEl = document.getElementById('detailStatus');
            if (data.status === 'completed') {
                statusEl.textContent = 'å·²å®Œæˆ';
                statusEl.className = 'status-tag';
            } else {
                statusEl.textContent = 'è¿›è¡Œä¸­';
                statusEl.className = 'status-tag current';
            }

            // ç”Ÿæˆäº‹ä»¶æ—¶é—´çº¿
            let html = '';
            data.events.forEach(event => {
                const pendingClass = event.pending ? ' pending' : '';
                const typeClass = event.type === 'story' ? ' story' : (event.type === 'video' ? ' video' : '');

                html += `<div class="detail-event${typeClass}${pendingClass}">`;
                html += `<h4>`;
                if (event.type === 'story') {
                    html += `<span class="tag story">å‰§æƒ…</span>`;
                } else if (event.type === 'video') {
                    html += `<span class="tag video">æŒ‡è¯</span>`;
                }
                html += `${event.title}</h4>`;
                html += `<p>${event.desc}</p>`;
                if (event.type === 'video' && !event.pending) {
                    html += `<button class="video-btn" onclick="playVideo('${event.title}')">â–¶ å›çœ‹æŒ‡è¯è§†é¢‘</button>`;
                }
                html += `</div>`;
            });

            document.getElementById('detailTimeline').innerHTML = html;

            // å›æº¯æŒ‰é’®çŠ¶æ€
            const replayBtn = document.getElementById('detailReplayBtn');
            if (data.status === 'current') {
                replayBtn.disabled = true;
                replayBtn.textContent = 'å½“å‰è¿›è¡Œä¸­';
            } else {
                replayBtn.disabled = false;
                replayBtn.textContent = 'âª å›æº¯è‡³æ­¤';
            }

            document.getElementById('detailModal').classList.add('active');
        }

        function closeDetail() {
            document.getElementById('detailModal').classList.remove('active');
        }

        function replayFromDetail() {
            const data = loopDetails[viewingLoop];
            if (data && data.status === 'completed') {
                if (confirm(`ç¡®å®šè¦å›æº¯åˆ°ã€Œ${data.title}ã€çš„èµ·ç‚¹å—ï¼Ÿ\n\nåç»­è¿›åº¦å°†è¢«é‡ç½®ã€‚`)) {
                    alert('æ­£åœ¨åŠ è½½å­˜æ¡£...\n\nï¼ˆæ¼”ç¤ºåŠŸèƒ½ï¼‰');
                    closeDetail();
                }
            }
        }

        function playVideo(title) {
            alert(`æ’­æ”¾ã€Œ${title}ã€è§†é¢‘...\n\nï¼ˆæ¼”ç¤ºåŠŸèƒ½ï¼‰`);
        }

        // è¿”å›è®¾ç½®é¡µé¢
        function goToSettings() {
            window.location.href = '../è®¾ç½®ç³»ç»Ÿ/settings_system.html';
        }

        function openDoc() {
            document.getElementById('docModal').classList.add('active');
        }

        function closeDoc() {
            document.getElementById('docModal').classList.remove('active');
        }

        document.getElementById('docModal').addEventListener('click', function(e) {
            if (e.target === this) closeDoc();
        });

        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) closeDetail();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDoc();
                closeDetail();
            }
        });
    </script>
</body>
</html>
